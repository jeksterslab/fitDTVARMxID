<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit the First-Order Discrete-Time Vector Autoregressive Model by ID — FitDTVARMxID • fitDTVARMxID</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the First-Order Discrete-Time Vector Autoregressive Model by ID — FitDTVARMxID"><meta name="description" content="The function fits
the first-order discrete-time vector autoregressive model
for each unit ID."><meta property="og:description" content="The function fits
the first-order discrete-time vector autoregressive model
for each unit ID."><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fitDTVARMxID</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/fitDTVARMxID.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jeksterslab/fitDTVARMxID/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit the First-Order Discrete-Time Vector Autoregressive Model by ID</h1>
      <small class="dont-index">Source: <a href="https://github.com/jeksterslab/fitDTVARMxID/blob/main/R/fitDTVARMxID-fit-dt-var-mx-id.R"><code>R/fitDTVARMxID-fit-dt-var-mx-id.R</code></a></small>
      <div class="d-none name"><code>FitDTVARMxID.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function fits
the first-order discrete-time vector autoregressive model
for each unit ID.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FitDTVARMxID</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">observed</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mu_eta_fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mu_eta_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu_eta_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu_eta_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu_eta_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha_fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  beta_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  psi_d_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_d_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_d_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_d_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_l_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_l_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_l_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi_l_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu_fixed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nu_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  theta_fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  theta_d_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_d_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_d_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_d_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_d_equal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  theta_l_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_l_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_l_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_l_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu0_fixed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mu0_func <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mu0_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu0_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu0_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu0_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_fixed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sigma0_func <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigma0_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigma0_d_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_d_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_d_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_d_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_l_free <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_l_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_l_lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma0_l_ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tries_explore <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  tries_local <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_attempts <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  grad_tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  hess_tol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"FitDTVARMxID"</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clean <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame.
A data frame object of data for potentially
multiple subjects that contain
a column of subject ID numbers
(i.e., an ID variable), and
at least one column of observed values.</p></dd>


<dt id="arg-observed">observed<a class="anchor" aria-label="anchor" href="#arg-observed"></a></dt>
<dd><p>Character vector.
A vector of character strings
of the names of the observed variables in the data.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Character string.
A character string of the name of the ID variable in the data.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>Logical.
If TRUE, use the mean-centered (mean-reverting) state equation.
Note that when <code>center = TRUE</code>, <code>alpha</code> is implied
and the set-point <code>mu_eta</code> is estimated.</p></dd>


<dt id="arg-mu-eta-fixed">mu_eta_fixed<a class="anchor" aria-label="anchor" href="#arg-mu-eta-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the dynamic model set-point vector <code>mu_eta</code> is fixed.
If <code>FALSE</code>, <code>mu_eta</code> is estimated.</p></dd>


<dt id="arg-mu-eta-free">mu_eta_free<a class="anchor" aria-label="anchor" href="#arg-mu-eta-free"></a></dt>
<dd><p>Logical vector indicating which elements of <code>mu_eta</code>
are freely estimated. If <code>NULL</code>, all elements are free.
Ignored if <code>mu_eta_fixed = TRUE</code>.</p></dd>


<dt id="arg-mu-eta-values">mu_eta_values<a class="anchor" aria-label="anchor" href="#arg-mu-eta-values"></a></dt>
<dd><p>Numeric vector of values for <code>mu_eta</code>.
If <code>mu_eta_fixed = TRUE</code>, these are fixed values.
If <code>mu_eta_fixed = FALSE</code>, these are starting values.
If <code>NULL</code>, defaults to a vector of zeros.</p></dd>


<dt id="arg-mu-eta-lbound">mu_eta_lbound<a class="anchor" aria-label="anchor" href="#arg-mu-eta-lbound"></a></dt>
<dd><p>Numeric vector of lower bounds for <code>mu_eta</code>.
If <code>NULL</code>, no lower bounds are set.
Ignored if <code>mu_eta_fixed = TRUE</code>.</p></dd>


<dt id="arg-mu-eta-ubound">mu_eta_ubound<a class="anchor" aria-label="anchor" href="#arg-mu-eta-ubound"></a></dt>
<dd><p>Numeric vector of upper bounds for <code>mu_eta</code>.
If <code>NULL</code>, no upper bounds are set.
Ignored if <code>mu_eta_fixed = TRUE</code>.</p></dd>


<dt id="arg-alpha-fixed">alpha_fixed<a class="anchor" aria-label="anchor" href="#arg-alpha-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the dynamic model intercept vector <code>alpha</code> is fixed.
If <code>FALSE</code>, <code>alpha</code> is estimated.</p></dd>


<dt id="arg-alpha-free">alpha_free<a class="anchor" aria-label="anchor" href="#arg-alpha-free"></a></dt>
<dd><p>Logical vector indicating which elements of <code>alpha</code>
are freely estimated. If <code>NULL</code>, all elements are free.
Ignored if <code>alpha_fixed = TRUE</code>.</p></dd>


<dt id="arg-alpha-values">alpha_values<a class="anchor" aria-label="anchor" href="#arg-alpha-values"></a></dt>
<dd><p>Numeric vector of values for <code>alpha</code>.
If <code>alpha_fixed = TRUE</code>, these are fixed values.
If <code>alpha_fixed = FALSE</code>, these are starting values.
If <code>NULL</code>, defaults to a vector of zeros.</p></dd>


<dt id="arg-alpha-lbound">alpha_lbound<a class="anchor" aria-label="anchor" href="#arg-alpha-lbound"></a></dt>
<dd><p>Numeric vector of lower bounds for <code>alpha</code>.
If <code>NULL</code>, no lower bounds are set.
Ignored if <code>alpha_fixed = TRUE</code>.</p></dd>


<dt id="arg-alpha-ubound">alpha_ubound<a class="anchor" aria-label="anchor" href="#arg-alpha-ubound"></a></dt>
<dd><p>Numeric vector of upper bounds for <code>alpha</code>.
If <code>NULL</code>, no upper bounds are set.
Ignored if <code>alpha_fixed = TRUE</code>.</p></dd>


<dt id="arg-beta-fixed">beta_fixed<a class="anchor" aria-label="anchor" href="#arg-beta-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the dynamic model coefficient matrix <code>beta</code> is fixed.
If <code>FALSE</code>, <code>beta</code> is estimated.</p></dd>


<dt id="arg-beta-free">beta_free<a class="anchor" aria-label="anchor" href="#arg-beta-free"></a></dt>
<dd><p>Logical matrix indicating which elements of <code>beta</code>
are freely estimated. If <code>NULL</code>, all elements are free.
Ignored if <code>beta_fixed = TRUE</code>.</p></dd>


<dt id="arg-beta-values">beta_values<a class="anchor" aria-label="anchor" href="#arg-beta-values"></a></dt>
<dd><p>Numeric matrix of values for <code>beta</code>.
If <code>beta_fixed = TRUE</code>, these are fixed values.
If <code>beta_fixed = FALSE</code>, these are starting values.
If <code>NULL</code>, defaults to a zero matrix.</p></dd>


<dt id="arg-beta-lbound">beta_lbound<a class="anchor" aria-label="anchor" href="#arg-beta-lbound"></a></dt>
<dd><p>Numeric matrix of lower bounds for <code>beta</code>.
If <code>NULL</code>, defaults to -1.5.
Ignored if <code>beta_fixed = TRUE</code>.</p></dd>


<dt id="arg-beta-ubound">beta_ubound<a class="anchor" aria-label="anchor" href="#arg-beta-ubound"></a></dt>
<dd><p>Numeric matrix of upper bounds for <code>beta</code>.
If <code>NULL</code>, defaults to +1.5.
Ignored if <code>beta_fixed = TRUE</code>.</p></dd>


<dt id="arg-psi-diag">psi_diag<a class="anchor" aria-label="anchor" href="#arg-psi-diag"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, <code>psi</code> is diagonal.
If <code>FALSE</code>, <code>psi</code> is symmetric.</p></dd>


<dt id="arg-psi-d-free">psi_d_free<a class="anchor" aria-label="anchor" href="#arg-psi-d-free"></a></dt>
<dd><p>Logical vector
indicating free/fixed status of the elements of <code>psi_d</code>.
If <code>NULL</code>, all element of <code>psi_d</code> are free.</p></dd>


<dt id="arg-psi-d-values">psi_d_values<a class="anchor" aria-label="anchor" href="#arg-psi-d-values"></a></dt>
<dd><p>Numeric vector
with starting values for <code>psi_d</code>.
If <code>NULL</code>, defaults to a vector of ones.</p></dd>


<dt id="arg-psi-d-lbound">psi_d_lbound<a class="anchor" aria-label="anchor" href="#arg-psi-d-lbound"></a></dt>
<dd><p>Numeric vector
with lower bounds for <code>psi_d</code>.
If <code>NULL</code>, no lower bounds are set.</p></dd>


<dt id="arg-psi-d-ubound">psi_d_ubound<a class="anchor" aria-label="anchor" href="#arg-psi-d-ubound"></a></dt>
<dd><p>Numeric vector
with upper bounds for <code>psi_d</code>.
If <code>NULL</code>, no upper bounds are set.</p></dd>


<dt id="arg-psi-l-free">psi_l_free<a class="anchor" aria-label="anchor" href="#arg-psi-l-free"></a></dt>
<dd><p>Logical matrix
indicating which strictly-lower-triangular elements of <code>psi_l</code> are free.
Ignored if <code>psi_diag = TRUE</code>.</p></dd>


<dt id="arg-psi-l-values">psi_l_values<a class="anchor" aria-label="anchor" href="#arg-psi-l-values"></a></dt>
<dd><p>Numeric matrix
of starting values for the strictly-lower-triangular elements of <code>psi_l</code>.
If <code>NULL</code>, defaults to a null matrix.</p></dd>


<dt id="arg-psi-l-lbound">psi_l_lbound<a class="anchor" aria-label="anchor" href="#arg-psi-l-lbound"></a></dt>
<dd><p>Numeric matrix
with lower bounds for <code>psi_l</code>.
If <code>NULL</code>, no lower bounds are set.</p></dd>


<dt id="arg-psi-l-ubound">psi_l_ubound<a class="anchor" aria-label="anchor" href="#arg-psi-l-ubound"></a></dt>
<dd><p>Numeric matrix
with upper bounds for <code>psi_l</code>.
If <code>NULL</code>, no upper bounds are set.</p></dd>


<dt id="arg-nu-fixed">nu_fixed<a class="anchor" aria-label="anchor" href="#arg-nu-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the measurement model intercept vector <code>nu</code> is fixed.
If <code>FALSE</code>, <code>nu</code> is estimated.</p></dd>


<dt id="arg-nu-free">nu_free<a class="anchor" aria-label="anchor" href="#arg-nu-free"></a></dt>
<dd><p>Logical vector indicating which elements of <code>nu</code>
are freely estimated. If <code>NULL</code>, all elements are free.
Ignored if <code>nu_fixed = TRUE</code>.</p></dd>


<dt id="arg-nu-values">nu_values<a class="anchor" aria-label="anchor" href="#arg-nu-values"></a></dt>
<dd><p>Numeric vector of values for <code>nu</code>.
If <code>nu_fixed = TRUE</code>, these are fixed values.
If <code>nu_fixed = FALSE</code>, these are starting values.
If <code>NULL</code>, defaults to a vector of zeros.</p></dd>


<dt id="arg-nu-lbound">nu_lbound<a class="anchor" aria-label="anchor" href="#arg-nu-lbound"></a></dt>
<dd><p>Numeric vector of lower bounds for <code>nu</code>.
If <code>NULL</code>, no lower bounds are set.
Ignored if <code>nu_fixed = TRUE</code>.</p></dd>


<dt id="arg-nu-ubound">nu_ubound<a class="anchor" aria-label="anchor" href="#arg-nu-ubound"></a></dt>
<dd><p>Numeric vector of upper bounds for <code>nu</code>.
If <code>NULL</code>, no upper bounds are set.
Ignored if <code>nu_fixed = TRUE</code>.</p></dd>


<dt id="arg-theta-diag">theta_diag<a class="anchor" aria-label="anchor" href="#arg-theta-diag"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, <code>theta</code> is diagonal.
If <code>FALSE</code>, <code>theta</code> is symmetric.</p></dd>


<dt id="arg-theta-fixed">theta_fixed<a class="anchor" aria-label="anchor" href="#arg-theta-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the measurement error matrix <code>theta</code>
is fixed to <code>SoftPlus(theta_d_values)</code>.
If <code>FALSE</code>, only diagonal elements are estimated
(off-diagonals fixed to zero).</p></dd>


<dt id="arg-theta-d-free">theta_d_free<a class="anchor" aria-label="anchor" href="#arg-theta-d-free"></a></dt>
<dd><p>Logical vector
indicating free/fixed status of the diagonal parameters <code>theta_d</code>.
If <code>NULL</code>, all element of <code>theta_d</code> are free.</p></dd>


<dt id="arg-theta-d-values">theta_d_values<a class="anchor" aria-label="anchor" href="#arg-theta-d-values"></a></dt>
<dd><p>Numeric vector
with starting values for <code>theta_d</code>.
If <code>theta_fixed = TRUE</code>, these are fixed values.
If <code>theta_fixed = FALSE</code>, these are starting values.
If <code>NULL</code>, defaults to an identity matrix.</p></dd>


<dt id="arg-theta-d-lbound">theta_d_lbound<a class="anchor" aria-label="anchor" href="#arg-theta-d-lbound"></a></dt>
<dd><p>Numeric vector
with lower bounds for <code>theta_d</code>.
If <code>NULL</code>, no lower bounds are set.</p></dd>


<dt id="arg-theta-d-ubound">theta_d_ubound<a class="anchor" aria-label="anchor" href="#arg-theta-d-ubound"></a></dt>
<dd><p>Numeric vector
with upper bounds for <code>theta_d</code>.
If <code>NULL</code>, no upper bounds are set.</p></dd>


<dt id="arg-theta-d-equal">theta_d_equal<a class="anchor" aria-label="anchor" href="#arg-theta-d-equal"></a></dt>
<dd><p>Logical.
When <code>TRUE</code>, all free diagonal elements of <code>theta_d</code> are constrained
to be equal and estimated as a single shared parameter (<code>theta_eq</code>).
Ignored if no diagonal elements are free.</p></dd>


<dt id="arg-theta-l-free">theta_l_free<a class="anchor" aria-label="anchor" href="#arg-theta-l-free"></a></dt>
<dd><p>Logical matrix
indicating which strictly-lower-triangular elements of <code>theta_l</code> are free.
Ignored if <code>theta_diag = TRUE</code>.</p></dd>


<dt id="arg-theta-l-values">theta_l_values<a class="anchor" aria-label="anchor" href="#arg-theta-l-values"></a></dt>
<dd><p>Numeric matrix
of starting values for the strictly-lower-triangular elements of <code>theta_l</code>.
If <code>NULL</code>, defaults to a null matrix.</p></dd>


<dt id="arg-theta-l-lbound">theta_l_lbound<a class="anchor" aria-label="anchor" href="#arg-theta-l-lbound"></a></dt>
<dd><p>Numeric matrix
with lower bounds for <code>theta_l</code>.
If <code>NULL</code>, no lower bounds are set.</p></dd>


<dt id="arg-theta-l-ubound">theta_l_ubound<a class="anchor" aria-label="anchor" href="#arg-theta-l-ubound"></a></dt>
<dd><p>Numeric matrix
with upper bounds for <code>theta_l</code>.
If <code>NULL</code>, no upper bounds are set.</p></dd>


<dt id="arg-mu-fixed">mu0_fixed<a class="anchor" aria-label="anchor" href="#arg-mu-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the initial mean vector <code>mu0</code> is fixed.
If <code>FALSE</code>, <code>mu0</code> is estimated.</p></dd>


<dt id="arg-mu-func">mu0_func<a class="anchor" aria-label="anchor" href="#arg-mu-func"></a></dt>
<dd><p>Logical.
If <code>TRUE</code> and <code>mu0_fixed = TRUE</code>, <code>mu0</code> is fixed to
\( (I - \beta)^{-1} \alpha \).</p></dd>


<dt id="arg-mu-free">mu0_free<a class="anchor" aria-label="anchor" href="#arg-mu-free"></a></dt>
<dd><p>Logical vector indicating which elements of <code>mu0</code>
are freely estimated.</p></dd>


<dt id="arg-mu-values">mu0_values<a class="anchor" aria-label="anchor" href="#arg-mu-values"></a></dt>
<dd><p>Numeric vector of values for <code>mu0</code>.
If <code>mu0_fixed = TRUE</code>, these are fixed values.
If <code>mu0_fixed = FALSE</code>, these are starting values.
If <code>NULL</code>, defaults to a vector of zeros.</p></dd>


<dt id="arg-mu-lbound">mu0_lbound<a class="anchor" aria-label="anchor" href="#arg-mu-lbound"></a></dt>
<dd><p>Numeric vector of lower bounds for <code>mu0</code>.
If <code>NULL</code>, no lower bounds are set.
Ignored if <code>mu0_fixed = TRUE</code>.</p></dd>


<dt id="arg-mu-ubound">mu0_ubound<a class="anchor" aria-label="anchor" href="#arg-mu-ubound"></a></dt>
<dd><p>Numeric vector of upper bounds for <code>mu0</code>.
If <code>NULL</code>, no upper bounds are set.
Ignored if <code>mu0_fixed = TRUE</code>.</p></dd>


<dt id="arg-sigma-fixed">sigma0_fixed<a class="anchor" aria-label="anchor" href="#arg-sigma-fixed"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, the initial covariance matrix <code>sigma0</code> is fixed.
If <code>FALSE</code>, <code>sigma0</code> is estimated.</p></dd>


<dt id="arg-sigma-func">sigma0_func<a class="anchor" aria-label="anchor" href="#arg-sigma-func"></a></dt>
<dd><p>Logical.
If <code>TRUE</code> and <code>sigma0_fixed = TRUE</code>, <code>sigma0</code> is fixed to
\( (I - \beta \otimes \beta)^{-1} \mathrm{Vec}(\Psi) \).</p></dd>


<dt id="arg-sigma-diag">sigma0_diag<a class="anchor" aria-label="anchor" href="#arg-sigma-diag"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, <code>sigma0</code> is diagonal.
If <code>FALSE</code>, <code>sigma0</code> is symmetric.</p></dd>


<dt id="arg-sigma-d-free">sigma0_d_free<a class="anchor" aria-label="anchor" href="#arg-sigma-d-free"></a></dt>
<dd><p>Logical vector
indicating free/fixed status of the elements of <code>sigma0_d</code>.
If <code>NULL</code>, all element of <code>sigma0_d</code> are free.</p></dd>


<dt id="arg-sigma-d-values">sigma0_d_values<a class="anchor" aria-label="anchor" href="#arg-sigma-d-values"></a></dt>
<dd><p>Numeric vector
with starting values for <code>sigma0_d</code>.
If <code>NULL</code>, defaults to a vector of ones.</p></dd>


<dt id="arg-sigma-d-lbound">sigma0_d_lbound<a class="anchor" aria-label="anchor" href="#arg-sigma-d-lbound"></a></dt>
<dd><p>Numeric vector
with lower bounds for <code>sigma0_d</code>.
If <code>NULL</code>, no lower bounds are set.</p></dd>


<dt id="arg-sigma-d-ubound">sigma0_d_ubound<a class="anchor" aria-label="anchor" href="#arg-sigma-d-ubound"></a></dt>
<dd><p>Numeric vector
with upper bounds for <code>sigma0_d</code>.
If <code>NULL</code>, no upper bounds are set.</p></dd>


<dt id="arg-sigma-l-free">sigma0_l_free<a class="anchor" aria-label="anchor" href="#arg-sigma-l-free"></a></dt>
<dd><p>Logical matrix
indicating which
strictly-lower-triangular elements of <code>sigma0_l</code> are free.
Ignored if <code>sigma0_diag = TRUE</code>.</p></dd>


<dt id="arg-sigma-l-values">sigma0_l_values<a class="anchor" aria-label="anchor" href="#arg-sigma-l-values"></a></dt>
<dd><p>Numeric matrix
of starting values
for the strictly-lower-triangular elements of <code>sigma0_l</code>.
If <code>NULL</code>, defaults to a null matrix.</p></dd>


<dt id="arg-sigma-l-lbound">sigma0_l_lbound<a class="anchor" aria-label="anchor" href="#arg-sigma-l-lbound"></a></dt>
<dd><p>Numeric matrix
with lower bounds for <code>sigma0_l</code>.
If <code>NULL</code>, no lower bounds are set.</p></dd>


<dt id="arg-sigma-l-ubound">sigma0_l_ubound<a class="anchor" aria-label="anchor" href="#arg-sigma-l-ubound"></a></dt>
<dd><p>Numeric matrix
with upper bounds for <code>sigma0_l</code>.
If <code>NULL</code>, no upper bounds are set.</p></dd>


<dt id="arg-robust">robust<a class="anchor" aria-label="anchor" href="#arg-robust"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, calculate robust (sandwich) sampling variance-covariance matrix.</p></dd>


<dt id="arg-tries-explore">tries_explore<a class="anchor" aria-label="anchor" href="#arg-tries-explore"></a></dt>
<dd><p>Integer.
Number of extra tries for the wide exploration
phase using <code><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">OpenMx::mxTryHardWideSearch()</a></code> with <code>checkHess = FALSE</code>.</p></dd>


<dt id="arg-tries-local">tries_local<a class="anchor" aria-label="anchor" href="#arg-tries-local"></a></dt>
<dd><p>Integer.
Number of extra tries for local polishing via
<code><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">OpenMx::mxTryHard()</a></code> when gradients remain above tolerance.</p></dd>


<dt id="arg-max-attempts">max_attempts<a class="anchor" aria-label="anchor" href="#arg-max-attempts"></a></dt>
<dd><p>Integer.
Maximum number of remediation attempts
after the first Hessian computation fails the criteria.
Each attempt may nudge off bounds,
refit locally without the Hessian, and,
on the last attempt, relax bounds.</p></dd>


<dt id="arg-grad-tol">grad_tol<a class="anchor" aria-label="anchor" href="#arg-grad-tol"></a></dt>
<dd><p>Numeric.
Tolerance for the maximum absolute gradient.
Smaller values are stricter.</p></dd>


<dt id="arg-hess-tol">hess_tol<a class="anchor" aria-label="anchor" href="#arg-hess-tol"></a></dt>
<dd><p>Numeric.
Minimum allowable Hessian eigenvalue.
Smaller values are less strict.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Numeric.
Proximity threshold to detect parameters on their bounds
and to nudge them inward by <code>10 * eps</code>.</p></dd>


<dt id="arg-factor">factor<a class="anchor" aria-label="anchor" href="#arg-factor"></a></dt>
<dd><p>Numeric.
Multiplicative factor to relax parameter bounds
on the final remediation attempt.
Lower bounds are divided by <code>factor</code> and
upper bounds are multiplied by <code>factor</code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, existing intermediate files are overwritten.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Character string.
Directory in which to save intermediate files.</p></dd>


<dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p>Alphanumeric character string.
Prefix to use when naming intermediate files.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed for reproducibility.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, suppresses messages during the model fitting stage.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Positive integer.
Number of cores to use.</p></dd>


<dt id="arg-clean">clean<a class="anchor" aria-label="anchor" href="#arg-clean"></a></dt>
<dd><p>Logical.
If <code>TRUE</code>, clean intermediate files saved in <code>path</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>dtvarmxid</code> which is
a list with the following elements:</p><dl><dt>call</dt>
<dd><p>Function call.</p></dd>

<dt>args</dt>
<dd><p>List of function arguments.</p></dd>

<dt>fun</dt>
<dd><p>Function used ("FitDTVARMxID").</p></dd>

<dt>output</dt>
<dd><p>A list of fitted OpenMx models.</p></dd>

<dt>robust</dt>
<dd><p>A list of output from <code><a href="https://rdrr.io/pkg/OpenMx/man/imxRobustSE.html" class="external-link">OpenMx::imxRobustSE()</a></code>
with argument <code>details = TRUE</code> for each <code>id</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The measurement model is given by
$$
  \mathbf{y}_{i, t}
  =
  \boldsymbol{\nu}
  +
  \boldsymbol{\Lambda}
  \boldsymbol{\eta}_{i, t}
  +
  \boldsymbol{\varepsilon}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\varepsilon}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Theta}
  \right)
$$
where
\(\mathbf{y}_{i, t}\),
\(\boldsymbol{\eta}_{i, t}\),
and
\(\boldsymbol{\varepsilon}_{i, t}\)
are random variables
and
\(\boldsymbol{\nu}\),
\(\boldsymbol{\Lambda}\),
and
\(\boldsymbol{\Theta}\)
are model parameters.
\(\mathbf{y}_{i, t}\)
represents a vector of observed random variables,
\(\boldsymbol{\eta}_{i, t}\)
a vector of latent random variables,
and
\(\boldsymbol{\varepsilon}_{i, t}\)
a vector of random measurement errors,
at time \(t\) and individual \(i\).
\(\boldsymbol{\nu}\),
denotes a vector of intercepts (fixed to a null vector by default),
\(\boldsymbol{\Lambda}\)
a matrix of factor loadings,
and
\(\boldsymbol{\Theta}\)
the covariance matrix of
\(\boldsymbol{\varepsilon}\).
In this model,
\(\boldsymbol{\Lambda}\) is an identity matrix and
\(\boldsymbol{\Theta}\) is a diagonal matrix.</p>
<p>The dynamic structure is given by
$$
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\alpha}
  +
  \boldsymbol{\beta}
  \boldsymbol{\eta}_{i, t - 1}
  +
  \boldsymbol{\zeta}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\zeta}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Psi}
  \right)
$$
where
\(\boldsymbol{\eta}_{i, t}\),
\(\boldsymbol{\eta}_{i, t - 1}\),
and
\(\boldsymbol{\zeta}_{i, t}\)
are random variables,
and
\(\boldsymbol{\alpha}\),
\(\boldsymbol{\beta}\),
and
\(\boldsymbol{\Psi}\)
are model parameters.
Here,
\(\boldsymbol{\eta}_{i, t}\)
is a vector of latent variables
at time \(t\) and individual \(i\),
\(\boldsymbol{\eta}_{i, t - 1}\)
represents a vector of latent variables
at time \(t - 1\) and individual \(i\),
and
\(\boldsymbol{\zeta}_{i, t}\)
represents a vector of dynamic noise
at time \(t\) and individual \(i\).
\(\boldsymbol{\alpha}\)
denotes a vector of intercepts,
\(\boldsymbol{\beta}\)
a matrix of autoregression
and cross regression coefficients,
and
\(\boldsymbol{\Psi}\)
the covariance matrix of
\(\boldsymbol{\zeta}_{i, t}\).</p>
<p>If <code>center = TRUE</code>, the dynamic structure is parameterized as follows
$$
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\mu}_{\boldsymbol{\eta}}
  +
  \boldsymbol{\beta}
  \left(
    \boldsymbol{\eta}_{i, t - 1}
    -
    \boldsymbol{\mu}_{\boldsymbol{\eta}}
  \right)
  +
  \boldsymbol{\zeta}_{i, t}
$$
where \(\boldsymbol{\mu}_{\boldsymbol{\eta}}\)
is equilibrium level of the latent state
toward which the system is pulled over time.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hunter, M. D. (2017).
State space modeling in an open source, modular,
structural equation modeling environment.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
<em>25</em>(2), 307–324.
<a href="https://doi.org/10.1080/10705511.2017.1369354" class="external-link">doi:10.1080/10705511.2017.1369354</a></p>
<p>Neale, M. C., Hunter, M. D., Pritikin, J. N.,
Zahery, M., Brick, T. R., Kirkpatrick, R. M., Estabrook, R.,
Bates, T. C., Maes, H. H., &amp; Boker, S. M. (2015).
OpenMx 2.0: Extended structural equation and statistical modeling.
<em>Psychometrika</em>,
<em>81</em>(2), 535–549.
<a href="https://doi.org/10.1007/s11336-014-9435-8" class="external-link">doi:10.1007/s11336-014-9435-8</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other DTVAR Functions:
<code><a href="LDL.html">LDL()</a></code>,
<code><a href="Softplus.html">Softplus()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ivan Jacob Agaloos Pesigan</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Generate data using the simStateSpace package------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5</span>, times <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.0</span>, <span class="fl">.2</span>, <span class="fl">.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  ncol <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.9</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.9</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  ncol <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">psi_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, times <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.8</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  ncol <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">-</span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">k</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span> <span class="op">-</span> <span class="va">beta</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html" class="external-link">%x%</a></span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  ncol <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma0_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">sigma0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simStateSpace</span><span class="fu">::</span><span class="fu"><a href="https://github.com/jeksterslab/simStateSpace/reference/SimSSMIVary.html" class="external-link">SimSSMIVary</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="va">n</span>,</span></span>
<span class="r-in"><span>  <span class="va">time</span>,</span></span>
<span class="r-in"><span>  mu0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mu0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigma0_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sigma0_l</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="fu">simStateSpace</span><span class="fu">::</span><span class="fu"><a href="https://github.com/jeksterslab/simStateSpace/reference/SimBetaN.html" class="external-link">SimBetaN</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="va">n</span>,</span></span>
<span class="r-in"><span>    beta <span class="op">=</span> <span class="va">beta</span>,</span></span>
<span class="r-in"><span>    vcov_beta_vec_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">k</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  psi_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">psi_l</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  theta_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">theta_l</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the model--------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># center = TRUE</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/fitDTVARMxID">fitDTVARMxID</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">FitDTVARMxID</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="st">"id"</span>,</span></span>
<span class="r-in"><span>  center <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="converged.html">converged</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the model--------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># center = FALSE</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/fitDTVARMxID">fitDTVARMxID</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">FitDTVARMxID</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="st">"id"</span>,</span></span>
<span class="r-in"><span>  center <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="converged.html">converged</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

