<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fit the Discrete-Time Vector Autoregressive Model By ID (Stable Reciprocal Regulation) â€¢ fitDTVARMxID</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the Discrete-Time Vector Autoregressive Model By ID (Stable Reciprocal Regulation)">
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fitDTVARMxID</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/fitDTVARMxID.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jeksterslab/fitDTVARMxID/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit the Discrete-Time Vector Autoregressive Model By ID (Stable Reciprocal Regulation)</h1>
                        <h4 data-toc-skip class="author">Ivan Jacob
Agaloos Pesigan</h4>
            
            <h4 data-toc-skip class="date">2025-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jeksterslab/fitDTVARMxID/blob/main/vignettes/stable-reciprocal-regulation.Rmd"><code>vignettes/stable-reciprocal-regulation.Rmd</code></a></small>
      <div class="d-none name"><code>stable-reciprocal-regulation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="dynamics-description">Dynamics Description<a class="anchor" aria-label="anchor" href="#dynamics-description"></a>
</h2>
<p>The <em>Stable Reciprocal Regulation</em> process represents a
bivariate dynamic system in which two latent psychological
constructsâ€”such as positive and negative affectâ€”mutually influence each
other over time. Each construct shows moderate self-regulation
(autoregressive effects) and mild opposing cross-effects, reflecting an
equilibrium-seeking mechanism characteristic of emotional balance.</p>
<p>Individuals vary in their self-regulatory tendencies and in the
strength of these antagonistic couplings. At the population level, the
transition matrix indicates that increases in one construct are followed
by slight decreases in the other, producing a stable, damped oscillatory
pattern around individual equilibrium points. The process noise
covariance allows for small correlated disturbances, while measurement
errors are assumed to be minimal and symmetric across indicators.</p>
<p>This dynamic pattern captures a psychologically plausible process of
<em>reciprocal inhibition</em>â€”where short-term fluctuations in one
system component (e.g., positive affect) are naturally counteracted by
adjustments in its counterpart (e.g., negative affect), leading to
emotional homeostasis over time.</p>
</div>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<p>The measurement model is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ²</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>ğ›</mi><mi>i</mi></msub><mo>+</mo><mi>ğš²</mi><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>ğ›†</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow><mspace width="1.0em"></mspace><msub><mi>ğ›†</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>ğŸ</mn><mo>,</mo><msub><mi>ğš¯</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
  \mathbf{y}_{i, t}
  =
  \boldsymbol{\nu}_{i}
  +
  \boldsymbol{\Lambda}
  \boldsymbol{\eta}_{i, t}
  +
  \boldsymbol{\varepsilon}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\varepsilon}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Theta}_{i}
  \right)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ²</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{y}_{i, t}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{i, t}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›†</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\varepsilon}_{i, t}</annotation></semantics></math>
are random variables and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\nu}_{i}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš²</mi><annotation encoding="application/x-tex">\boldsymbol{\Lambda}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğš¯</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Theta}_{i}</annotation></semantics></math>
are model parameters.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ²</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{y}_{i, t}</annotation></semantics></math>
represents a vector of observed random variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{i, t}</annotation></semantics></math>
a vector of latent random variables, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›†</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\varepsilon}_{i, t}</annotation></semantics></math>
a vector of random measurement errors, at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš²</mi><annotation encoding="application/x-tex">\boldsymbol{\Lambda}</annotation></semantics></math>
denotes a matrix of factor loadings, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğš¯</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Theta}_{i}</annotation></semantics></math>
the covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›†</mi><annotation encoding="application/x-tex">\boldsymbol{\varepsilon}</annotation></semantics></math>
for individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
In this model,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš²</mi><annotation encoding="application/x-tex">\boldsymbol{\Lambda}</annotation></semantics></math>
is an identity matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğš¯</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Theta}_{i}</annotation></semantics></math>
is a symmetric matrix.</p>
<p>The dynamic structure is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>ğ›ƒ</mi><mi>i</mi></msub><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ğ›‡</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow><mspace width="1.0em"></mspace><msub><mi>ğ›‡</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>ğŸ</mn><mo>,</mo><msub><mi>ğš¿</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\beta}_{i}
  \boldsymbol{\eta}_{i, t - 1}
  +
  \boldsymbol{\zeta}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\zeta}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Psi}_{i}
  \right)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{i, t}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{i, t - 1}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›‡</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\zeta}_{i, t}</annotation></semantics></math>
are random variables, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ƒ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_{i}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğš¿</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Psi}_{i}</annotation></semantics></math>
are model parameters. Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{i, t}</annotation></semantics></math>
is a vector of latent variables at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{i, t - 1}</annotation></semantics></math>
represents a vector of latent variables at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t - 1</annotation></semantics></math>
and individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›‡</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\zeta}_{i, t}</annotation></semantics></math>
represents a vector of dynamic noise at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ƒ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_{i}</annotation></semantics></math>
is a matrix of autoregression and cross regression coefficients for
individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğš¿</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Psi}_{i}</annotation></semantics></math>
the covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›‡</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\zeta}_{i, t}</annotation></semantics></math>
for individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
In this model,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğš¿</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\Psi}_{i}</annotation></semantics></math>
is a symmetric matrix.</p>
</div>
<div class="section level2">
<h2 id="data-generation">Data Generation<a class="anchor" aria-label="anchor" href="#data-generation"></a>
</h2>
<div class="section level3">
<h3 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>10100</mn></mrow><annotation encoding="application/x-tex">t = 10100</annotation></semantics></math>
be the number of time points and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n = 100</annotation></semantics></math>
be the number of individuals.</p>
<p>Let the measurement model intecept vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›</mi><annotation encoding="application/x-tex">\boldsymbol{\nu}</annotation></semantics></math>
be normally distributed with the following means</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.5</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\left(
\begin{array}{c}
  0.5 \\
  -0.5 \\
\end{array}
\right)
\end{equation}</annotation></semantics></math></p>
<p>and covariance matrix</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0.1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.05</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.05</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\left(
\begin{array}{cc}
  0.1 &amp; -0.05 \\
  -0.05 &amp; 0.1 \\
\end{array}
\right) .
\end{equation}</annotation></semantics></math></p>
<p>Let the factor loadings matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš²</mi><annotation encoding="application/x-tex">\boldsymbol{\Lambda}</annotation></semantics></math>
be given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğš²</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\boldsymbol{\Lambda}
=
\left(
\begin{array}{cc}
  1 &amp; 0 \\
  0 &amp; 1 \\
\end{array}
\right) .
\end{equation}</annotation></semantics></math></p>
<p>Let the measurement error covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš¯</mi><annotation encoding="application/x-tex">\boldsymbol{\Theta}</annotation></semantics></math>
be given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğš¯</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0.04</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.04</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\boldsymbol{\Theta}
=
\left(
\begin{array}{cc}
  0.04 &amp; 0 \\
  0 &amp; 0.04 \\
\end{array}
\right) .
\end{equation}</annotation></semantics></math></p>
<p>Let the initial condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›ˆ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{0}</annotation></semantics></math>
be given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›ˆ</mi><mn>0</mn></msub><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ›</mi><mrow><mi>ğ›ˆ</mi><mo>âˆ£</mo><mn>0</mn></mrow></msub><mo>,</mo><msub><mi>ğšº</mi><mrow><mi>ğ›ˆ</mi><mo>âˆ£</mo><mn>0</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\boldsymbol{\eta}_{0} \sim \mathcal{N} \left( \boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}, \boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0} \right) .
\end{equation}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mrow><mi>ğ›ˆ</mi><mo>âˆ£</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğšº</mi><mrow><mi>ğ›ˆ</mi><mo>âˆ£</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</annotation></semantics></math>
are functions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›‚</mi><annotation encoding="application/x-tex">\boldsymbol{\alpha}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›ƒ</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>.</p>
<p>Let the transition matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›ƒ</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
be normally distributed with the following means</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0.7</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.15</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.65</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\left(
\begin{array}{cc}
  0.7 &amp; -0.2 \\
  -0.15 &amp; 0.65 \\
\end{array}
\right)
\end{equation}</annotation></semantics></math></p>
<p>and covariance matrix</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0.02</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.01</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0.01</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.015</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.01</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.005</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.005</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.015</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\left(
\begin{array}{cccc}
  0.02 &amp; 0.01 &amp; 0 &amp; 0 \\
  0.01 &amp; 0.015 &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 0.01 &amp; 0.005 \\
  0 &amp; 0 &amp; 0.005 &amp; 0.015 \\
\end{array}
\right) .
\end{equation}</annotation></semantics></math></p>
<p>Let the intercept vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›‚</mi><annotation encoding="application/x-tex">\boldsymbol{\alpha}</annotation></semantics></math>
be fixed to a zero vector.</p>
<p>The <code>SimNuN</code> and <code>SimBetaN</code> functions from the
<code>simStateSpace</code> package generates random intercept vectors
and transition matrices from the multivariate normal distribution. Note
that the <code>SimBetaN</code> function generates transition matrices
that are weakly stationary with an option to set lower and upper
bounds.</p>
<p>Let the dynamic process noise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš¿</mi><annotation encoding="application/x-tex">\boldsymbol{\Psi}</annotation></semantics></math>
be given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğš¿</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0.2</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.05</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>0.05</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.18</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\boldsymbol{\Psi}
=
\left(
\begin{array}{cc}
  0.2 &amp; -0.05 \\
  -0.05 &amp; 0.18 \\
\end{array}
\right) .
\end{equation}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="r-function-arguments">R Function Arguments<a class="anchor" aria-label="anchor" href="#r-function-arguments"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="va">time</span></span>
<span><span class="co">#&gt; [1] 10100</span></span>
<span><span class="va">burnin</span></span>
<span><span class="co">#&gt; [1] 10000</span></span>
<span><span class="co"># first mu0 in the list of length n</span></span>
<span><span class="va">mu0</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span>
<span><span class="co"># first sigma0 in the list of length n</span></span>
<span><span class="va">sigma0</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;            [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.3230830 -0.1220195</span></span>
<span><span class="co">#&gt; [2,] -0.1220195  0.5527409</span></span>
<span><span class="co"># first sigma0_l in the list of length n</span></span>
<span><span class="va">sigma0_l</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># sigma0_l &lt;- t(chol(sigma0))</span></span>
<span><span class="co">#&gt;            [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.5684039 0.0000000</span></span>
<span><span class="co">#&gt; [2,] -0.2146704 0.7117988</span></span>
<span><span class="va">alpha</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span>
<span><span class="co"># first beta in the list of length n</span></span>
<span><span class="va">beta</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;            [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.6248343 0.02174497</span></span>
<span><span class="co">#&gt; [2,] -0.1054576 0.79427204</span></span>
<span><span class="co"># first psi in the list of length n</span></span>
<span><span class="va">psi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;       [,1]  [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.20 -0.05</span></span>
<span><span class="co">#&gt; [2,] -0.05  0.18</span></span>
<span><span class="va">psi_l</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># psi_l &lt;- t(chol(psi))</span></span>
<span><span class="co">#&gt;            [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.4472136 0.0000000</span></span>
<span><span class="co">#&gt; [2,] -0.1118034 0.4092676</span></span>
<span><span class="co"># first nu in the list of length n</span></span>
<span><span class="va">nu</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  0.7369682 -0.4934186</span></span>
<span><span class="va">lambda</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]    0    1</span></span>
<span><span class="co"># first theta in the list of length n</span></span>
<span><span class="va">theta</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.04 0.00</span></span>
<span><span class="co">#&gt; [2,] 0.00 0.04</span></span>
<span><span class="va">theta_l</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># theta_l &lt;- t(chol(theta))</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.2  0.0</span></span>
<span><span class="co">#&gt; [2,]  0.0  0.2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-the-simssmivary-function-from-the-simstatespace-package-to-simulate-data">Using the <code>SimSSMIVary</code> Function from the
<code>simStateSpace</code> Package to Simulate Data<a class="anchor" aria-label="anchor" href="#using-the-simssmivary-function-from-the-simstatespace-package-to-simulate-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/simStateSpace" class="external-link">simStateSpace</a></span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/simStateSpace/reference/SimSSMIVary.html" class="external-link">SimSSMIVary</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="va">n</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  mu0 <span class="op">=</span> <span class="va">mu0</span>,</span>
<span>  sigma0_l <span class="op">=</span> <span class="va">sigma0_l</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  psi_l <span class="op">=</span> <span class="va">psi_l</span>,</span>
<span>  nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  theta_l <span class="op">=</span> <span class="va">theta_l</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sim</span>, burnin <span class="op">=</span> <span class="va">burnin</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id time        y1         y2</span></span>
<span><span class="co">#&gt; 1  1    0 0.3679123 -1.1084155</span></span>
<span><span class="co">#&gt; 2  1    1 0.4443673 -1.2596854</span></span>
<span><span class="co">#&gt; 3  1    2 0.2801909 -0.2118373</span></span>
<span><span class="co">#&gt; 4  1    3 1.0360259 -0.3262629</span></span>
<span><span class="co">#&gt; 5  1    4 1.4075254 -1.3072584</span></span>
<span><span class="co">#&gt; 6  1    5 0.2984624 -0.3442870</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, burnin <span class="op">=</span> <span class="va">burnin</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-stable-reciprical-regulation-unnamed-chunk-7-1.png" width="3300"><img src="fig-vignettes-stable-reciprical-regulation-unnamed-chunk-7-2.png" width="3300"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/fitDTVARMxID">fitDTVARMxID</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>FitDTVARMxID</code> function fits a DT-VAR model on each
individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
To set up the estimation, we first provide <strong>starting
values</strong> for each parameter matrix.</p>
<div class="section level3">
<h3 id="autoregressive-parameters-beta">Autoregressive Parameters (<code>beta</code>)<a class="anchor" aria-label="anchor" href="#autoregressive-parameters-beta"></a>
</h3>
<p>The autoregressive coefficient matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›ƒ</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
is given starting values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta_values</span> <span class="op">&lt;-</span> <span class="va">beta</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="intercepts-nu">Intercepts (<code>nu</code>)<a class="anchor" aria-label="anchor" href="#intercepts-nu"></a>
</h3>
<p>The intercept vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›</mi><annotation encoding="application/x-tex">\boldsymbol{\nu}</annotation></semantics></math>
is initialized with starting values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nu_values</span> <span class="op">&lt;-</span> <span class="va">nu</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ldl-parameterized-covariance-matrices">LDLâ€²-parameterized covariance matrices<a class="anchor" aria-label="anchor" href="#ldl-parameterized-covariance-matrices"></a>
</h3>
<p>Covariances such as <code>psi</code> and <code>theta</code> are
estimated using the LDLâ€² decomposition of a positive definite covariance
matrix. The decomposition expresses a covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğšº</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‹</mi><mo>+</mo><mi>ğˆ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ</mi><mrow><mi>u</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‹</mi><mo>+</mo><mi>ğˆ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
  \boldsymbol{\Sigma} = \left( \mathbf{L} + \mathbf{I} \right) \mathrm{diag} \left( \mathrm{Softplus} \left( \mathbf{d}_{uc} \right) \right) \left( \mathbf{L} + \mathbf{I} \right)^{\prime},
\end{equation}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‹</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
is a strictly lower-triangular matrix of free parameters
(<code>l_mat_strict</code>),<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğˆ</mi><annotation encoding="application/x-tex">\mathbf{I}</annotation></semantics></math>
is the identity matrix,<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ</mi><mrow><mi>u</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{d}_{uc}</annotation></semantics></math>
is an unconstrained vector,<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ</mi><mrow><mi>u</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mi mathvariant="normal">log</mi><mo>â¡</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi mathvariant="normal">exp</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ</mi><mrow><mi>u</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{Softplus} \left(\mathbf{d}_{uc} \right) = \log \left(1 + \exp \left( \mathbf{d}_{uc} \right) \right)</annotation></semantics></math>
ensures strictly positive diagonal entries.</li>
</ul>
<p>The <code><a href="../reference/LDL.html">LDL()</a></code> function extracts this decomposition from a
positive definite covariance matrix. It returns:</p>
<ul>
<li>
<code>d_uc</code>: unconstrained diagonal parameters, equal to
<code>InvSoftplus(d_vec)</code>,<br>
</li>
<li>
<code>d_vec</code>: diagonal entries, equal to
<code>Softplus(d_uc)</code>,<br>
</li>
<li>
<code>l_mat_strict</code>: the strictly lower-triangular
factor.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ldl_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LDL.html">LDL</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="va">d_uc</span> <span class="op">&lt;-</span> <span class="va">ldl_sigma</span><span class="op">$</span><span class="va">d_uc</span></span>
<span><span class="va">l_mat_strict</span> <span class="op">&lt;-</span> <span class="va">ldl_sigma</span><span class="op">$</span><span class="va">l_mat_strict</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sigma_reconstructed</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">l_mat_strict</span> <span class="op">+</span> <span class="va">I</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log1p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">d_uc</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">l_mat_strict</span> <span class="op">+</span> <span class="va">I</span><span class="op">)</span></span>
<span><span class="va">sigma_reconstructed</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.0  0.5</span></span>
<span><span class="co">#&gt; [2,]  0.5  1.0</span></span></code></pre></div>
<div class="section level4">
<h4 id="process-noise-covariance-matrix-psi">Process Noise Covariance Matrix (<code>psi</code>)<a class="anchor" aria-label="anchor" href="#process-noise-covariance-matrix-psi"></a>
</h4>
<p>Starting values for the process noise covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš¿</mi><annotation encoding="application/x-tex">\boldsymbol{\Psi}</annotation></semantics></math>
are given below, with corresponding LDLâ€² parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psi_values</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ldl_psi_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LDL.html">LDL</a></span><span class="op">(</span><span class="va">psi_values</span><span class="op">)</span></span>
<span><span class="va">psi_d_values</span> <span class="op">&lt;-</span> <span class="va">ldl_psi_values</span><span class="op">$</span><span class="va">d_uc</span></span>
<span><span class="va">psi_l_values</span> <span class="op">&lt;-</span> <span class="va">ldl_psi_values</span><span class="op">$</span><span class="va">l_mat_strict</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psi_d_values</span></span>
<span><span class="co">#&gt; [1] -1.507772 -1.701853</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psi_l_values</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.00    0</span></span>
<span><span class="co">#&gt; [2,] -0.25    0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="measurement-error-covariance-matrix-theta">Measurement Error Covariance Matrix (<code>theta</code>)<a class="anchor" aria-label="anchor" href="#measurement-error-covariance-matrix-theta"></a>
</h4>
<p>Starting values for the measurement error covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš¯</mi><annotation encoding="application/x-tex">\boldsymbol{\Theta}</annotation></semantics></math>
are given below, with corresponding LDLâ€² parameters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_values</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ldl_theta_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LDL.html">LDL</a></span><span class="op">(</span><span class="va">theta_values</span><span class="op">)</span></span>
<span><span class="va">theta_d_values</span> <span class="op">&lt;-</span> <span class="va">ldl_theta_values</span><span class="op">$</span><span class="va">d_uc</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_d_values</span></span>
<span><span class="co">#&gt; [1] -3.198809 -3.198809</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="initial-mean-vector-mu_0-and-covariance-matrix-sigma_0">Initial mean vector (<code>mu_0</code>) and covariance matrix
(<code>sigma_0</code>)<a class="anchor" aria-label="anchor" href="#initial-mean-vector-mu_0-and-covariance-matrix-sigma_0"></a>
</h3>
<p>The initial mean vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mn>ğŸ</mn></msub><annotation encoding="application/x-tex">\boldsymbol{\mu_0}</annotation></semantics></math>
and covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğšº</mi><mn>ğŸ</mn></msub><annotation encoding="application/x-tex">\boldsymbol{\Sigma_0}</annotation></semantics></math>
are fixed using <code>mu0</code> and <code>sigma0</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu0_values</span> <span class="op">&lt;-</span> <span class="va">mu0</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma0_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">sigma0</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">LDL</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sigma0_d_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">sigma0_values</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">i</span><span class="op">$</span><span class="va">d_uc</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sigma0_l_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">sigma0_values</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">i</span><span class="op">$</span><span class="va">l_mat_strict</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitdtvarmxid">
<code>FitDTVARMxID</code><a class="anchor" aria-label="anchor" href="#fitdtvarmxid"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FitDTVARMxID.html">FitDTVARMxID</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  beta_values <span class="op">=</span> <span class="va">beta_values</span>,</span>
<span>  psi_d_values <span class="op">=</span> <span class="va">psi_d_values</span>,</span>
<span>  psi_l_values <span class="op">=</span> <span class="va">psi_l_values</span>,</span>
<span>  nu_values <span class="op">=</span> <span class="va">nu_values</span>,</span>
<span>  theta_d_values <span class="op">=</span> <span class="va">theta_d_values</span>,</span>
<span>  theta_d_equal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mu0_values <span class="op">=</span> <span class="va">mu0_values</span>,</span>
<span>  sigma0_d_values <span class="op">=</span> <span class="va">sigma0_d_values</span>,</span>
<span>  sigma0_l_values <span class="op">=</span> <span class="va">sigma0_l_values</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Intermediate files will be saved in /home/ibp5092/work/jeksterslab/devel_fitDTVARMxID/vignettes</span></span>
<span><span class="co">#&gt; Warning in parallel::mclapply(X = model, FUN = .MxHelperReadRunSave,</span></span>
<span><span class="co">#&gt; tries_explore = tries_explore, : scheduled cores 3, 7, 8, 6, 2, 4, 1</span></span>
<span><span class="co">#&gt; encountered errors in user code, all values of the jobs will be affected</span></span></code></pre></div>
<div class="section level4">
<h4 id="means-of-parameter-estimates">Means of parameter estimates<a class="anchor" aria-label="anchor" href="#means-of-parameter-estimates"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, means <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   beta_1_1   beta_2_1   beta_1_2   beta_2_2     nu_1_1     nu_2_1  psi_l_2_1 </span></span>
<span><span class="co">#&gt;  0.6482783 -0.1853922 -0.1927488  0.6168938  0.4638306 -0.4847460 -0.2445400 </span></span>
<span><span class="co">#&gt;  psi_d_1_1  psi_d_2_1 theta_d_eq </span></span>
<span><span class="co">#&gt; -1.6333661 -1.9208184 -8.0000754</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="proportion-of-converged-cases">Proportion of converged cases<a class="anchor" aria-label="anchor" href="#proportion-of-converged-cases"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/converged.html">converged</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.74</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Hunter-2017" class="csl-entry">
Hunter, M. D. (2017). State space modeling in an open source, modular,
structural equation modeling environment. <em>Structural Equation
Modeling: A Multidisciplinary Journal</em>, <em>25</em>(2), 307â€“324. <a href="https://doi.org/10.1080/10705511.2017.1369354" class="external-link">https://doi.org/10.1080/10705511.2017.1369354</a>
</div>
<div id="ref-Neale-Hunter-Pritikin-etal-2015" class="csl-entry">
Neale, M. C., Hunter, M. D., Pritikin, J. N., Zahery, M., Brick, T. R.,
Kirkpatrick, R. M., Estabrook, R., Bates, T. C., Maes, H. H., &amp;
Boker, S. M. (2015). <span>OpenMx</span> 2.0: Extended structural
equation and statistical modeling. <em>Psychometrika</em>,
<em>81</em>(2), 535â€“549. <a href="https://doi.org/10.1007/s11336-014-9435-8" class="external-link">https://doi.org/10.1007/s11336-014-9435-8</a>
</div>
<div id="ref-RCoreTeam-2024" class="csl-entry">
R Core Team. (2024). <em><span>R</span>: A language and environment for
statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
