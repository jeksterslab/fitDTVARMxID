---
title: "Fit the Discrete-Time Vector Autoregressive Model By ID (Stable Reciprocal Regulation | 1000 Measurement Occasions)"
author: Ivan Jacob Agaloos Pesigan
date: "2025-10-15"
bibliography: "vignettes.bib"
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
nocite: |
  @RCoreTeam-2024
  @Neale-Hunter-Pritikin-etal-2015
  @Hunter-2017
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Fit the Discrete-Time Vector Autoregressive Model By ID (Stable Reciprocal Regulation | 1000 Measurement Occasions)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---









## Dynamics Description

The *Stable Reciprocal Regulation* process represents a bivariate dynamic system in which two latent psychological constructs---such as positive and negative affect---mutually influence each other over time. Each construct shows moderate self-regulation (autoregressive effects) and mild opposing cross-effects, reflecting an equilibrium-seeking mechanism characteristic of emotional balance.

Individuals vary in their self-regulatory tendencies and in the strength of these antagonistic couplings. At the population level, the transition matrix indicates that increases in one construct are followed by slight decreases in the other, producing a stable, damped oscillatory pattern around individual equilibrium points. The process noise covariance allows for small correlated disturbances, while measurement errors are assumed to be minimal and symmetric across indicators.

This dynamic pattern captures a psychologically plausible process of *reciprocal inhibition*---where short-term fluctuations in one system component (e.g., positive affect) are naturally counteracted by adjustments in its counterpart (e.g., negative affect), leading to emotional homeostasis over time.

## Model

The measurement model is given by
\begin{equation}
  \mathbf{y}_{i, t}
  =
  \boldsymbol{\nu}_{i}
  +
  \boldsymbol{\Lambda}
  \boldsymbol{\eta}_{i, t}
  +
  \boldsymbol{\varepsilon}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\varepsilon}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Theta}_{i}
  \right)
\end{equation}
where
$\mathbf{y}_{i, t}$,
$\boldsymbol{\eta}_{i, t}$,
and
$\boldsymbol{\varepsilon}_{i, t}$
are random variables
and
$\boldsymbol{\nu}_{i}$,
$\boldsymbol{\Lambda}$,
and
$\boldsymbol{\Theta}_{i}$
are model parameters.
$\mathbf{y}_{i, t}$
represents a vector of observed random variables,
$\boldsymbol{\eta}_{i, t}$
a vector of latent random variables,
and
$\boldsymbol{\varepsilon}_{i, t}$
a vector of random measurement errors,
at time $t$ and individual $i$.
$\boldsymbol{\Lambda}$
denotes a matrix of factor loadings,
and
$\boldsymbol{\Theta}_{i}$
the covariance matrix of
$\boldsymbol{\varepsilon}$
for individual $i$.
In this model,
$\boldsymbol{\Lambda}$ is an identity matrix and
$\boldsymbol{\Theta}_{i}$ is a symmetric matrix.

The dynamic structure is given by
\begin{equation}
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\beta}_{i}
  \boldsymbol{\eta}_{i, t - 1}
  +
  \boldsymbol{\zeta}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\zeta}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Psi}_{i}
  \right)
\end{equation}
where
$\boldsymbol{\eta}_{i, t}$,
$\boldsymbol{\eta}_{i, t - 1}$,
and
$\boldsymbol{\zeta}_{i, t}$
are random variables,
and
$\boldsymbol{\beta}_{i}$,
and
$\boldsymbol{\Psi}_{i}$
are model parameters.
Here,
$\boldsymbol{\eta}_{i, t}$
is a vector of latent variables
at time $t$ and individual $i$,
$\boldsymbol{\eta}_{i, t - 1}$
represents a vector of latent variables
at time $t - 1$ and individual $i$,
and
$\boldsymbol{\zeta}_{i, t}$
represents a vector of dynamic noise
at time $t$ and individual $i$.
$\boldsymbol{\beta}_{i}$ is
a matrix of autoregression
and cross regression coefficients
for individual $i$,
and
$\boldsymbol{\Psi}_{i}$
the covariance matrix of
$\boldsymbol{\zeta}_{i, t}$
for individual $i$.
In this model,
$\boldsymbol{\Psi}_{i}$ is a symmetric matrix.

## Data Generation

### Notation

Let $t = 11000$ be the number of time points and $n = 100$ be the number of individuals.

Let the measurement model intecept vector $\boldsymbol{\nu}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{c}
  0.5 \\
  -0.5 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cc}
  0.1 & -0.05 \\
  -0.05 & 0.1 \\
\end{array}
\right) .
\end{equation}

Let the factor loadings matrix $\boldsymbol{\Lambda}$ be given by

\begin{equation}
\boldsymbol{\Lambda}
=
\left(
\begin{array}{cc}
  1 & 0 \\
  0 & 1 \\
\end{array}
\right) .
\end{equation}

Let the measurement error covariance matrix $\boldsymbol{\Theta}$ be given by

\begin{equation}
\boldsymbol{\Theta}
=
\left(
\begin{array}{cc}
  0.5 & 0 \\
  0 & 0.5 \\
\end{array}
\right) .
\end{equation}

Let the initial condition
$\boldsymbol{\eta}_{0}$
be given by

\begin{equation}
\boldsymbol{\eta}_{0} \sim \mathcal{N} \left( \boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}, \boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0} \right) .
\end{equation}

$\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}$ and $\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}$ are functions of $\boldsymbol{\alpha}$ and $\boldsymbol{\beta}$.

Let the transition matrix $\boldsymbol{\beta}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{cc}
  0.7 & -0.2 \\
  -0.15 & 0.65 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cccc}
  0.02 & 0.01 & 0 & 0 \\
  0.01 & 0.015 & 0 & 0 \\
  0 & 0 & 0.01 & 0.005 \\
  0 & 0 & 0.005 & 0.015 \\
\end{array}
\right) .
\end{equation}

Let the intercept vector $\boldsymbol{\alpha}$ be fixed to a zero vector.

The `SimNuN` and `SimBetaN` functions from the `simStateSpace` package generates random intercept vectors and transition matrices from the multivariate normal distribution. Note that the `SimBetaN` function generates transition matrices that are weakly stationary with an option to set lower and upper bounds.

Let the dynamic process noise $\boldsymbol{\Psi}$ be given by

\begin{equation}
\boldsymbol{\Psi}
=
\left(
\begin{array}{cc}
  0.2 & -0.05 \\
  -0.05 & 0.18 \\
\end{array}
\right) .
\end{equation}




### R Function Arguments


``` r
n
#> [1] 100
time
#> [1] 11000
burnin
#> [1] 10000
# first mu0 in the list of length n
mu0[[1]]
#> [1] 0 0
# first sigma0 in the list of length n
sigma0[[1]]
#>            [,1]       [,2]
#> [1,]  0.3230830 -0.1220195
#> [2,] -0.1220195  0.5527409
# first sigma0_l in the list of length n
sigma0_l[[1]] # sigma0_l <- t(chol(sigma0))
#>            [,1]      [,2]
#> [1,]  0.5684039 0.0000000
#> [2,] -0.2146704 0.7117988
alpha
#> [[1]]
#> [1] 0 0
# first beta in the list of length n
beta[[1]]
#>            [,1]       [,2]
#> [1,]  0.6248343 0.02174497
#> [2,] -0.1054576 0.79427204
# first psi in the list of length n
psi[[1]]
#>       [,1]  [,2]
#> [1,]  0.20 -0.05
#> [2,] -0.05  0.18
psi_l[[1]] # psi_l <- t(chol(psi))
#>            [,1]      [,2]
#> [1,]  0.4472136 0.0000000
#> [2,] -0.1118034 0.4092676
# first nu in the list of length n
nu[[1]]
#> [1]  0.4832070 -0.7620639
lambda
#> [[1]]
#>      [,1] [,2]
#> [1,]    1    0
#> [2,]    0    1
# first theta in the list of length n
theta[[1]]
#>      [,1] [,2]
#> [1,]  0.5  0.0
#> [2,]  0.0  0.5
theta_l[[1]] # theta_l <- t(chol(theta))
#>           [,1]      [,2]
#> [1,] 0.7071068 0.0000000
#> [2,] 0.0000000 0.7071068
```

### Visualizing the Dynamics Without Process Noise and Measurement Error (n = 5 with Different Initial Condition)

<img src="fig-vignettes-stable-reciprical-regulation-no-error-1.png" width="3300" /><img src="fig-vignettes-stable-reciprical-regulation-no-error-2.png" width="3300" />

### Using the `SimSSMIVary` Function from the `simStateSpace` Package to Simulate Data


``` r
library(simStateSpace)
sim <- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l
)
data <- as.data.frame(sim, burnin = burnin)
head(data)
#>   id time         y1         y2
#> 1  1    0  0.2789887 -0.8588146
#> 2  1    1  1.7403454 -2.6296446
#> 3  1    2  1.6616097 -2.8627551
#> 4  1    3  1.5364391 -2.8515134
#> 5  1    4  1.3548295 -3.3594792
#> 6  1    5 -1.4337840 -1.2245788
plot(sim, burnin = burnin)
```

<img src="fig-vignettes-stable-reciprical-regulation-error-1.png" width="3300" /><img src="fig-vignettes-stable-reciprical-regulation-error-2.png" width="3300" />

## Model Fitting




``` r
library(OpenMx)
library(fitDTVARMxID)
```

The `FitDTVARMxID` function fits a DT-VAR model on each individual $i$.
To set up the estimation, we first provide **starting values** for each parameter matrix.

### Autoregressive Parameters (`beta`)

The autoregressive coefficient matrix $\boldsymbol{\beta}$ is given starting values.


``` r
beta_values <- beta
```

### Intercepts (`nu`)

The intercept vector $\boldsymbol{\nu}$ is initialized with starting values.


``` r
nu_values <- nu
```

### LDL′-parameterized covariance matrices

Covariances such as `psi` and `theta` are estimated using the LDL′ decomposition of a positive definite covariance matrix. The decomposition expresses a covariance matrix $\Sigma$ as

\begin{equation}
  \boldsymbol{\Sigma} = \left( \mathbf{L} + \mathbf{I} \right) \mathrm{diag} \left( \mathrm{Softplus} \left( \mathbf{d}_{uc} \right) \right) \left( \mathbf{L} + \mathbf{I} \right)^{\prime},
\end{equation}

where:

- $\mathbf{L}$ is a strictly lower-triangular matrix of free parameters (`l_mat_strict`),
- $\mathbf{I}$ is the identity matrix,
- $\mathbf{d}_{uc}$ is an unconstrained vector,
- $\mathrm{Softplus} \left(\mathbf{d}_{uc} \right) = \log \left(1 + \exp \left( \mathbf{d}_{uc} \right) \right)$ ensures strictly positive diagonal entries.

The `LDL()` function extracts this decomposition from a positive definite covariance matrix. It returns:

- `d_uc`: unconstrained diagonal parameters, equal to `InvSoftplus(d_vec)`,
- `d_vec`: diagonal entries, equal to `Softplus(d_uc)`,
- `l_mat_strict`: the strictly lower-triangular factor.


``` r
sigma <- matrix(
  data = c(1.0, 0.5, 0.5, 1.0),
  nrow = 2,
  ncol = 2
)

ldl_sigma <- LDL(sigma)
d_uc <- ldl_sigma$d_uc
l_mat_strict <- ldl_sigma$l_mat_strict
I <- diag(2)
sigma_reconstructed <- (l_mat_strict + I) %*% diag(log1p(exp(d_uc)), 2) %*% t(l_mat_strict + I)
sigma_reconstructed
#>      [,1] [,2]
#> [1,]  1.0  0.5
#> [2,]  0.5  1.0
```

#### Process Noise Covariance Matrix (`psi`)

Starting values for the process noise covariance matrix $\boldsymbol{\Psi}$ are given below, with corresponding LDL′ parameters.


``` r
psi_values <- psi[[1]]
ldl_psi_values <- LDL(psi_values)
psi_d_values <- ldl_psi_values$d_uc
psi_l_values <- ldl_psi_values$l_mat_strict
```


``` r
psi_d_values
#> [1] -1.507772 -1.701853
```


``` r
psi_l_values
#>       [,1] [,2]
#> [1,]  0.00    0
#> [2,] -0.25    0
```

#### Measurement Error Covariance Matrix (`theta`)

Starting values for the measurement error covariance matrix $\boldsymbol{\Theta}$ are given below, with corresponding LDL′ parameters.


``` r
theta_values <- theta[[1]]
ldl_theta_values <- LDL(theta_values)
theta_d_values <- ldl_theta_values$d_uc
theta_l_values <- ldl_theta_values$l_mat_strict
```


``` r
theta_d_values
#> [1] -0.4327521 -0.4327521
```


``` r
theta_l_values
#>      [,1] [,2]
#> [1,]    0    0
#> [2,]    0    0
```

### Initial mean vector (`mu_0`) and covariance matrix (`sigma_0`)

The initial mean vector $\boldsymbol{\mu_0}$ and covariance matrix $\boldsymbol{\Sigma_0}$
are fixed using `mu0` and `sigma0`.


``` r
mu0_values <- mu0
```


``` r
sigma0_values <- lapply(
  X = sigma0,
  FUN = LDL
)
sigma0_d_values <- lapply(
  X = sigma0_values,
  FUN = function(i) {
    i$d_uc
  }
)
sigma0_l_values <- lapply(
  X = sigma0_values,
  FUN = function(i) {
    i$l_mat_strict
  }
)
```

### `FitDTVARMxID`


``` r
fit <- FitDTVARMxID(
  data = data,
  observed = c("y1", "y2"),
  id = "id",
  beta_values = beta_values,
  psi_d_values = psi_d_values,
  psi_l_values = psi_l_values,
  nu_values = nu_values,
  theta_d_values = theta_d_values,
  mu0_values = mu0_values,
  sigma0_d_values = sigma0_d_values,
  sigma0_l_values = sigma0_l_values,
  ncores = parallel::detectCores()
)
```

#### Parameter estimates


``` r
summary(fit, converged = FALSE)
#>                                beta_1_1     beta_2_1     beta_1_2  beta_2_2
#> FitDTVARMxID_DTVAR_ID1.Rds   0.53684650 -0.070155315 -0.070656961 0.7653616
#> FitDTVARMxID_DTVAR_ID2.Rds   0.60471987 -0.168854364 -0.203094662 0.8712974
#> FitDTVARMxID_DTVAR_ID3.Rds   0.55976949 -0.113189584 -0.303981606 0.5021822
#> FitDTVARMxID_DTVAR_ID4.Rds   0.47753319 -0.240060123 -0.330066982 0.7128059
#> FitDTVARMxID_DTVAR_ID5.Rds   0.74142548  0.005900227 -0.086740562 0.8470024
#> FitDTVARMxID_DTVAR_ID6.Rds   0.58941867 -0.032978624 -0.046041414 0.7210699
#> FitDTVARMxID_DTVAR_ID7.Rds   0.95045761 -1.671691717  0.013522794 0.1441060
#> FitDTVARMxID_DTVAR_ID8.Rds   0.77707390 -0.004450473 -0.270779568 0.8246968
#> FitDTVARMxID_DTVAR_ID9.Rds   0.89724618  0.003576820 -0.129480222 0.4868815
#> FitDTVARMxID_DTVAR_ID10.Rds  0.70943458 -0.041115749 -0.056398163 0.4701041
#> FitDTVARMxID_DTVAR_ID11.Rds  0.89594089 -0.306113349  0.036828028 0.6397776
#> FitDTVARMxID_DTVAR_ID12.Rds  0.79386462 -0.339106033 -0.052020660 0.1682424
#> FitDTVARMxID_DTVAR_ID13.Rds  0.65113976 -0.207437901 -0.029302148 0.7394328
#> FitDTVARMxID_DTVAR_ID14.Rds  0.65530748 -0.050656076 -0.320195090 0.8013550
#> FitDTVARMxID_DTVAR_ID15.Rds  0.71768018 -0.036079260 -0.426831802 0.7309561
#> FitDTVARMxID_DTVAR_ID16.Rds  0.90415442  0.017614848 -0.115629155 0.5051110
#> FitDTVARMxID_DTVAR_ID17.Rds  0.30234393 -0.442421139 -0.155475007 0.7332157
#> FitDTVARMxID_DTVAR_ID18.Rds  0.69268352 -0.338577629 -0.173505234 0.6287573
#> FitDTVARMxID_DTVAR_ID19.Rds  0.80092527  0.006948721 -0.246881835 0.5224722
#> FitDTVARMxID_DTVAR_ID20.Rds  0.92315554  0.153993845 -0.096420799 0.6474991
#> FitDTVARMxID_DTVAR_ID21.Rds  0.38808931 -0.043072285 -0.222734104 0.8225084
#> FitDTVARMxID_DTVAR_ID22.Rds  0.65508598 -0.071087090 -0.111889543 0.7459309
#> FitDTVARMxID_DTVAR_ID23.Rds  0.88863523 -0.017538428 -0.194465801 0.6766754
#> FitDTVARMxID_DTVAR_ID24.Rds  0.72817760  0.050263467 -0.311116896 0.8067636
#> FitDTVARMxID_DTVAR_ID25.Rds  0.91939968 -0.165483459  0.031932121 0.6714481
#> FitDTVARMxID_DTVAR_ID26.Rds  0.82393488  0.027985574 -0.283528607 0.8514050
#> FitDTVARMxID_DTVAR_ID27.Rds  0.72681499 -0.098878666 -0.262282758 0.5200191
#> FitDTVARMxID_DTVAR_ID28.Rds  0.33372279 -0.149009444 -0.876763897 0.6791609
#> FitDTVARMxID_DTVAR_ID29.Rds  0.71818221 -0.282819492  0.015531281 0.5218688
#> FitDTVARMxID_DTVAR_ID30.Rds  0.02384132 -0.117012064 -0.377401463 0.6712522
#> FitDTVARMxID_DTVAR_ID31.Rds  0.88780221 -0.033992022 -0.124849431 0.7844649
#> FitDTVARMxID_DTVAR_ID32.Rds  0.47947335 -0.366859180 -0.154620957 0.7720164
#> FitDTVARMxID_DTVAR_ID33.Rds  0.50332861 -0.328800925 -0.240751836 0.5598705
#> FitDTVARMxID_DTVAR_ID34.Rds  0.52684119 -0.285782673 -0.194250869 0.7663324
#> FitDTVARMxID_DTVAR_ID35.Rds  0.84115732 -0.033010175 -0.070872103 0.7809974
#> FitDTVARMxID_DTVAR_ID36.Rds  0.55669405 -0.239926884 -0.058941861 0.6456413
#> FitDTVARMxID_DTVAR_ID37.Rds  0.19918288 -0.149293019 -0.546537070 0.8314061
#> FitDTVARMxID_DTVAR_ID38.Rds  0.47353310 -0.223341278 -0.415535259 0.7706299
#> FitDTVARMxID_DTVAR_ID39.Rds  0.68430758 -0.128864424 -0.125403003 0.4990782
#> FitDTVARMxID_DTVAR_ID40.Rds  0.87024979 -0.321992314  0.144822191 0.3502718
#> FitDTVARMxID_DTVAR_ID41.Rds  0.74033684 -0.295817780  0.118138826 0.6636864
#> FitDTVARMxID_DTVAR_ID42.Rds  0.71348405 -0.040177097 -0.145280682 0.8884379
#> FitDTVARMxID_DTVAR_ID43.Rds  0.56916779  0.002272543 -0.464089609 0.9493354
#> FitDTVARMxID_DTVAR_ID44.Rds  0.70857724 -0.144857934 -0.202125450 0.6658578
#> FitDTVARMxID_DTVAR_ID45.Rds  0.64045223 -0.223086132 -0.257318304 0.6735460
#> FitDTVARMxID_DTVAR_ID46.Rds  0.12786155 -0.030917411 -1.208631454 0.7669008
#> FitDTVARMxID_DTVAR_ID47.Rds  0.86647688 -0.252795439 -0.151354908 0.1040695
#> FitDTVARMxID_DTVAR_ID48.Rds  0.25899913 -0.160008033 -0.411066753 0.7357825
#> FitDTVARMxID_DTVAR_ID49.Rds  0.60964182 -0.204685047 -0.247400907 0.6605563
#> FitDTVARMxID_DTVAR_ID50.Rds  0.80354180 -0.150676997 -0.054975770 0.6994743
#> FitDTVARMxID_DTVAR_ID51.Rds  0.46696002 -0.286406696 -0.244113819 0.6132603
#> FitDTVARMxID_DTVAR_ID53.Rds  0.62504471 -0.179284400 -0.285817591 0.4799800
#> FitDTVARMxID_DTVAR_ID54.Rds  0.13424377 -0.058783361 -0.575454586 0.7794681
#> FitDTVARMxID_DTVAR_ID55.Rds  0.12004527  0.017490381 -1.184726151 0.7135505
#> FitDTVARMxID_DTVAR_ID56.Rds  0.72035059 -0.240571117 -0.045030130 0.7555256
#> FitDTVARMxID_DTVAR_ID57.Rds  0.63503685 -0.070831366 -0.161022482 0.8001488
#> FitDTVARMxID_DTVAR_ID58.Rds  0.27906364 -0.185077387  0.043951646 0.6795664
#> FitDTVARMxID_DTVAR_ID59.Rds  0.81508343 -0.358659793 -0.020664232 0.6041762
#> FitDTVARMxID_DTVAR_ID60.Rds  0.74844685 -0.154633369 -0.086740668 0.7711791
#> FitDTVARMxID_DTVAR_ID61.Rds  0.96112108  0.086774514 -0.210315769 0.7315226
#> FitDTVARMxID_DTVAR_ID62.Rds  0.73547439 -0.436838688 -0.141261115 0.5763865
#> FitDTVARMxID_DTVAR_ID63.Rds  0.81334916 -0.156258030 -0.148770755 0.6623198
#> FitDTVARMxID_DTVAR_ID64.Rds  0.77835189 -0.014709809 -0.126723784 0.7338651
#> FitDTVARMxID_DTVAR_ID65.Rds  0.83244496 -0.259319570 -0.003465870 0.6866045
#> FitDTVARMxID_DTVAR_ID66.Rds  0.45360641 -0.183576943 -0.525587649 0.7115709
#> FitDTVARMxID_DTVAR_ID67.Rds  0.61779500 -0.198246555 -0.236173835 0.7420898
#> FitDTVARMxID_DTVAR_ID68.Rds  0.81434758 -0.217265911 -0.167323371 0.6744200
#> FitDTVARMxID_DTVAR_ID69.Rds  0.16266092 -0.062251520 -0.903492709 0.8180712
#> FitDTVARMxID_DTVAR_ID70.Rds  0.16144999 -0.030786748 -0.943454627 0.7473247
#> FitDTVARMxID_DTVAR_ID71.Rds  0.82160137 -0.411642691 -0.008264796 0.1156130
#> FitDTVARMxID_DTVAR_ID72.Rds  0.23729917 -0.111776051 -0.333236885 0.7849636
#> FitDTVARMxID_DTVAR_ID73.Rds  0.72910966 -0.164461349 -0.151330242 0.2115388
#> FitDTVARMxID_DTVAR_ID74.Rds  0.59824959 -0.236116673 -0.200838260 0.5023326
#> FitDTVARMxID_DTVAR_ID75.Rds  0.19774016 -0.140314330 -0.105650070 0.8878962
#> FitDTVARMxID_DTVAR_ID76.Rds  0.67614666 -0.399371969 -0.285982371 0.4336092
#> FitDTVARMxID_DTVAR_ID77.Rds  0.59065517 -0.116714544 -0.391914447 0.6799462
#> FitDTVARMxID_DTVAR_ID78.Rds  0.85839758 -0.186285707 -0.101468712 0.4940950
#> FitDTVARMxID_DTVAR_ID79.Rds  0.77187498 -0.293284925 -0.078056926 0.5042903
#> FitDTVARMxID_DTVAR_ID80.Rds  0.71563862 -0.234051811 -0.120229422 0.6355905
#> FitDTVARMxID_DTVAR_ID81.Rds  0.74483851 -0.154099837 -0.144663711 0.8417692
#> FitDTVARMxID_DTVAR_ID82.Rds  0.62643313 -0.226993916 -0.284620915 0.6703467
#> FitDTVARMxID_DTVAR_ID83.Rds  0.39035712 -0.128033996 -0.604263048 0.5848332
#> FitDTVARMxID_DTVAR_ID84.Rds  0.41622504 -0.189089371 -0.099135919 0.8659637
#> FitDTVARMxID_DTVAR_ID85.Rds  0.71828751 -0.455477826 -0.071927515 0.5080312
#> FitDTVARMxID_DTVAR_ID86.Rds  0.82495840  0.024951446 -0.764410649 0.9016016
#> FitDTVARMxID_DTVAR_ID87.Rds  0.69700031 -0.144459297 -0.087527973 0.4955359
#> FitDTVARMxID_DTVAR_ID88.Rds  0.74962704 -0.224206675 -0.330229823 0.4260571
#> FitDTVARMxID_DTVAR_ID89.Rds  0.74318729 -0.167183551 -0.131203231 0.6683592
#> FitDTVARMxID_DTVAR_ID90.Rds  0.79093833 -0.141984118 -0.105699040 0.5595485
#> FitDTVARMxID_DTVAR_ID91.Rds  0.90994368 -0.477251102  0.126696191 0.5579578
#> FitDTVARMxID_DTVAR_ID92.Rds  0.70815636  0.049169673 -0.096949454 0.4881485
#> FitDTVARMxID_DTVAR_ID93.Rds  0.45072611 -0.112477431 -0.005967988 0.9117174
#> FitDTVARMxID_DTVAR_ID94.Rds  0.48031240 -0.149718875 -0.124853764 0.8450989
#> FitDTVARMxID_DTVAR_ID95.Rds  0.58468676 -0.025038934 -0.140121691 0.7062472
#> FitDTVARMxID_DTVAR_ID96.Rds  0.80343520 -0.498944625 -0.026099349 0.5807857
#> FitDTVARMxID_DTVAR_ID97.Rds  0.59070601 -0.254112495 -0.214864427 0.4245270
#> FitDTVARMxID_DTVAR_ID98.Rds  0.53486613 -0.489353667 -0.056810191 0.6810314
#> FitDTVARMxID_DTVAR_ID99.Rds  1.01649075 -0.336257785  0.127999593 0.5734146
#> FitDTVARMxID_DTVAR_ID100.Rds 0.75941425  0.073547902 -0.210583707 0.5556849
#>                                    nu_1_1      nu_2_1   psi_l_2_1   psi_d_1_1
#> FitDTVARMxID_DTVAR_ID1.Rds    0.436531229 -0.81859451 -0.10775656 -1.26784495
#> FitDTVARMxID_DTVAR_ID2.Rds    0.422388638 -0.29922683 -0.05990397 -0.92560355
#> FitDTVARMxID_DTVAR_ID3.Rds    0.882918272 -0.28747050 -0.21673994 -1.26971997
#> FitDTVARMxID_DTVAR_ID4.Rds    1.003987073 -1.20263637 -0.19967895 -1.42224110
#> FitDTVARMxID_DTVAR_ID5.Rds    0.203906971 -0.15127094 -0.23483470 -1.50160687
#> FitDTVARMxID_DTVAR_ID6.Rds    0.729266462 -0.75793703 -0.25572737 -1.29446096
#> FitDTVARMxID_DTVAR_ID7.Rds    0.769573455 -0.43983834  0.23654673 -3.27078070
#> FitDTVARMxID_DTVAR_ID8.Rds    0.277922163 -0.25607375 -0.26077359 -1.59134723
#> FitDTVARMxID_DTVAR_ID9.Rds    0.842779766 -1.01279289 -0.32907633 -1.35249377
#> FitDTVARMxID_DTVAR_ID10.Rds   0.565042528 -0.38128475 -0.54874110 -2.04895100
#> FitDTVARMxID_DTVAR_ID11.Rds  -0.081155961  0.24413335 -0.64739925 -2.36540895
#> FitDTVARMxID_DTVAR_ID12.Rds   0.693046537 -0.29742291 -0.39602385 -1.71315190
#> FitDTVARMxID_DTVAR_ID13.Rds   0.093897550 -0.87559211 -0.16914087 -2.36763985
#> FitDTVARMxID_DTVAR_ID14.Rds   0.867491218 -0.64049960 -0.20481125 -1.43729015
#> FitDTVARMxID_DTVAR_ID15.Rds   0.813823765 -0.93089763 -0.37408880 -1.43947565
#> FitDTVARMxID_DTVAR_ID16.Rds   0.642929413 -1.30524255 -0.30377058 -1.40278432
#> FitDTVARMxID_DTVAR_ID17.Rds   0.977505386 -1.04690182 -0.06907703 -1.06958007
#> FitDTVARMxID_DTVAR_ID18.Rds   0.057704284 -0.21829830 -0.03201994 -1.37911148
#> FitDTVARMxID_DTVAR_ID19.Rds   0.319813177 -0.21510694 -0.40340176 -1.60727209
#> FitDTVARMxID_DTVAR_ID20.Rds   0.603878045 -0.12318125 -0.10328925 -1.50528146
#> FitDTVARMxID_DTVAR_ID21.Rds   1.000765767 -0.93872416 -0.26983217 -1.22887424
#> FitDTVARMxID_DTVAR_ID22.Rds   0.822381931 -0.92312593 -0.26681443 -1.27389763
#> FitDTVARMxID_DTVAR_ID23.Rds   0.454432290 -0.21674976 -0.38415071 -1.50907761
#> FitDTVARMxID_DTVAR_ID24.Rds   0.222071154 -0.30653300 -0.35956385 -1.69059356
#> FitDTVARMxID_DTVAR_ID25.Rds   0.603310083 -0.91353746 -0.38150505 -1.65496692
#> FitDTVARMxID_DTVAR_ID26.Rds   0.696330579 -0.52296468 -0.21446944 -1.31423696
#> FitDTVARMxID_DTVAR_ID27.Rds   0.414499643 -0.26790535 -0.18408807 -1.15995371
#> FitDTVARMxID_DTVAR_ID28.Rds   0.276506602 -0.37394943  0.03753354 -0.55654955
#> FitDTVARMxID_DTVAR_ID29.Rds   0.622050663 -0.69010219 -0.20143406 -1.46389366
#> FitDTVARMxID_DTVAR_ID30.Rds   0.246430571 -0.14677366 -0.08806348 -0.12765820
#> FitDTVARMxID_DTVAR_ID31.Rds   0.692478017 -0.75315821 -0.23156186 -1.64260578
#> FitDTVARMxID_DTVAR_ID32.Rds   0.602274762 -0.70631713 -0.31142620 -1.39004322
#> FitDTVARMxID_DTVAR_ID33.Rds   0.731863377 -0.73196932 -0.27470139 -1.26109190
#> FitDTVARMxID_DTVAR_ID34.Rds   0.487086441 -0.40319240 -0.14242906 -1.15761226
#> FitDTVARMxID_DTVAR_ID35.Rds   0.329056817 -0.47125940 -0.32717951 -1.35060090
#> FitDTVARMxID_DTVAR_ID36.Rds   0.314933639 -0.38737134 -0.41422999 -1.48471915
#> FitDTVARMxID_DTVAR_ID37.Rds   0.787520728 -0.44603527 -0.08313223  0.16690461
#> FitDTVARMxID_DTVAR_ID38.Rds   0.281686685  0.17869326 -0.15528848 -0.92427489
#> FitDTVARMxID_DTVAR_ID39.Rds   0.610017590 -0.56713424 -0.18128062 -1.71071392
#> FitDTVARMxID_DTVAR_ID40.Rds   0.437540638 -0.60756244 -0.57924023 -1.94293415
#> FitDTVARMxID_DTVAR_ID41.Rds   0.407954378 -0.87092212 -0.41038839 -2.06036372
#> FitDTVARMxID_DTVAR_ID42.Rds   0.225941183 -0.33221400 -0.47594001 -1.56957583
#> FitDTVARMxID_DTVAR_ID43.Rds   0.573764093 -0.63240433 -0.33489607 -1.43005611
#> FitDTVARMxID_DTVAR_ID44.Rds   0.171811573  0.12448918 -0.31518568 -1.32881302
#> FitDTVARMxID_DTVAR_ID45.Rds   0.497720005 -0.48974405 -0.07401886 -1.44210453
#> FitDTVARMxID_DTVAR_ID46.Rds   0.725282992 -0.79092053 -0.01323568 -0.02905516
#> FitDTVARMxID_DTVAR_ID47.Rds   0.550276415 -0.27899288 -0.28796074 -1.26104092
#> FitDTVARMxID_DTVAR_ID48.Rds   0.633947602 -0.61864889 -0.11683145  0.18680638
#> FitDTVARMxID_DTVAR_ID49.Rds   0.309481067 -0.09796161 -0.30251548 -1.50630302
#> FitDTVARMxID_DTVAR_ID50.Rds   0.867347212 -0.89743015 -0.38569424 -1.78797257
#> FitDTVARMxID_DTVAR_ID51.Rds   0.680888496 -0.26189092 -0.16648459 -1.07946686
#> FitDTVARMxID_DTVAR_ID53.Rds   0.743004782 -0.48832248 -0.28934699 -1.46227092
#> FitDTVARMxID_DTVAR_ID54.Rds  -0.038443271 -0.03520393 -0.11493448  0.04720324
#> FitDTVARMxID_DTVAR_ID55.Rds   0.777386179 -0.87718643 -0.03720493 -0.11908378
#> FitDTVARMxID_DTVAR_ID56.Rds   0.518447476 -0.11767957 -0.54705868 -1.64355466
#> FitDTVARMxID_DTVAR_ID57.Rds   0.712873916 -0.92289903 -0.28579762 -1.28246458
#> FitDTVARMxID_DTVAR_ID58.Rds   0.585444843 -0.54366746 -0.25607208 -0.49392019
#> FitDTVARMxID_DTVAR_ID59.Rds   0.498917231 -0.31636735 -0.25884557 -1.51416968
#> FitDTVARMxID_DTVAR_ID60.Rds  -0.337624806  0.03610091 -0.24639512 -2.03084461
#> FitDTVARMxID_DTVAR_ID61.Rds   0.742997184 -0.30948843 -0.07433335 -1.40196474
#> FitDTVARMxID_DTVAR_ID62.Rds   0.256888692 -0.84769088 -0.55319384 -2.08458580
#> FitDTVARMxID_DTVAR_ID63.Rds   0.445371274 -0.38100184 -0.24161358 -1.53173300
#> FitDTVARMxID_DTVAR_ID64.Rds   0.577425545 -1.02077056 -0.26246709 -1.84395994
#> FitDTVARMxID_DTVAR_ID65.Rds  -0.001270851 -0.27381040 -0.11058671 -1.60853339
#> FitDTVARMxID_DTVAR_ID66.Rds   0.317365436  0.02914544 -0.02433456 -1.02889579
#> FitDTVARMxID_DTVAR_ID67.Rds   0.466101585 -0.63033782 -0.32316877 -1.80521072
#> FitDTVARMxID_DTVAR_ID68.Rds   0.448853766 -0.50105857 -0.51144809 -2.07023486
#> FitDTVARMxID_DTVAR_ID69.Rds   0.869286479 -0.81278036 -0.08171943 -0.53162753
#> FitDTVARMxID_DTVAR_ID70.Rds   0.747445917 -0.68712951 -0.10536529  0.12141688
#> FitDTVARMxID_DTVAR_ID71.Rds   0.307741123 -0.35132670 -0.44133382 -1.51882857
#> FitDTVARMxID_DTVAR_ID72.Rds   0.714424435 -0.05499873 -0.08445386  0.17872544
#> FitDTVARMxID_DTVAR_ID73.Rds   0.582600629 -0.45993060 -0.36964023 -1.18769087
#> FitDTVARMxID_DTVAR_ID74.Rds   0.534883476 -0.51466313 -0.18250505 -1.15096123
#> FitDTVARMxID_DTVAR_ID75.Rds   0.691722866 -0.32074132 -0.15194008  0.11799236
#> FitDTVARMxID_DTVAR_ID76.Rds   0.709012927 -0.72649822 -0.09571948 -1.39804597
#> FitDTVARMxID_DTVAR_ID77.Rds   0.184079835 -0.36513077 -0.05957793 -1.48240512
#> FitDTVARMxID_DTVAR_ID78.Rds   0.177187468 -0.55425695 -0.40726179 -1.70811182
#> FitDTVARMxID_DTVAR_ID79.Rds   0.980146632 -0.68497013 -0.19694528 -1.59041527
#> FitDTVARMxID_DTVAR_ID80.Rds   0.260739421 -0.22422365 -0.37444226 -1.49695349
#> FitDTVARMxID_DTVAR_ID81.Rds   0.289082594 -0.16118959 -0.35327146 -1.56202686
#> FitDTVARMxID_DTVAR_ID82.Rds   1.015223604 -0.60303535 -0.11173346 -1.25989642
#> FitDTVARMxID_DTVAR_ID83.Rds   0.493014910 -0.38340609 -0.03308684 -0.68077488
#> FitDTVARMxID_DTVAR_ID84.Rds   0.180329542 -0.23565568 -0.07517320 -1.35444877
#> FitDTVARMxID_DTVAR_ID85.Rds   0.613398597 -0.84957911 -0.16241658 -1.45199021
#> FitDTVARMxID_DTVAR_ID86.Rds   0.663267124 -0.42046772 -0.09145304 -1.81874674
#> FitDTVARMxID_DTVAR_ID87.Rds   0.539948619 -0.70595811 -0.40048924 -1.31924128
#> FitDTVARMxID_DTVAR_ID88.Rds   0.741595355 -0.29344157 -0.30419123 -1.30249534
#> FitDTVARMxID_DTVAR_ID89.Rds   0.541679672 -0.35532872 -0.22442124 -1.14924274
#> FitDTVARMxID_DTVAR_ID90.Rds   0.642165834 -0.01008955 -0.15479316 -1.57181059
#> FitDTVARMxID_DTVAR_ID91.Rds   0.147445675 -0.11301522 -0.72174636 -2.49656010
#> FitDTVARMxID_DTVAR_ID92.Rds   0.076189228 -0.41471839 -0.33143793 -1.40936689
#> FitDTVARMxID_DTVAR_ID93.Rds   0.499247225 -0.27507179 -0.27848459 -1.35777831
#> FitDTVARMxID_DTVAR_ID94.Rds   0.074907437 -0.14425970 -0.15677202 -1.08547383
#> FitDTVARMxID_DTVAR_ID95.Rds   0.970707528 -0.85494649 -0.24970820 -1.22582495
#> FitDTVARMxID_DTVAR_ID96.Rds   0.830997685 -0.25941050 -0.08069098 -1.94232364
#> FitDTVARMxID_DTVAR_ID97.Rds   0.842997152 -0.50978460 -0.33074407 -1.26690844
#> FitDTVARMxID_DTVAR_ID98.Rds   0.769769272 -0.68602872 -0.05567144 -1.63511953
#> FitDTVARMxID_DTVAR_ID99.Rds   0.178195085 -0.64178127 -0.68983780 -2.50426174
#> FitDTVARMxID_DTVAR_ID100.Rds  0.157555948 -0.66193947 -0.43037137 -1.46029606
#>                                 psi_d_2_1  theta_d_1_1   theta_d_2_1
#> FitDTVARMxID_DTVAR_ID1.Rds   -1.871813930  -0.48644778  -0.358533477
#> FitDTVARMxID_DTVAR_ID2.Rds   -1.823325707  -0.59859014  -0.369063824
#> FitDTVARMxID_DTVAR_ID3.Rds   -1.006699613  -0.54436019  -0.619955950
#> FitDTVARMxID_DTVAR_ID4.Rds   -1.923440848  -0.46137807  -0.199677641
#> FitDTVARMxID_DTVAR_ID5.Rds   -2.119681854  -0.49567018  -0.265033378
#> FitDTVARMxID_DTVAR_ID6.Rds   -1.739955487  -0.48743727  -0.453796829
#> FitDTVARMxID_DTVAR_ID7.Rds   -0.527120023  -0.08093924  -1.989826102
#> FitDTVARMxID_DTVAR_ID8.Rds   -2.588323256  -0.35308957  -0.374818564
#> FitDTVARMxID_DTVAR_ID9.Rds   -1.051316619  -0.47818426  -0.888982480
#> FitDTVARMxID_DTVAR_ID10.Rds  -1.393511913  -0.21468152  -0.731038309
#> FitDTVARMxID_DTVAR_ID11.Rds  -2.410270974  -0.30923578  -0.260908256
#> FitDTVARMxID_DTVAR_ID12.Rds  -0.097138447  -0.56630217  -2.656952361
#> FitDTVARMxID_DTVAR_ID13.Rds  -1.506955010  -0.14665695  -0.538973466
#> FitDTVARMxID_DTVAR_ID14.Rds  -2.355106653  -0.34236155  -0.085878202
#> FitDTVARMxID_DTVAR_ID15.Rds  -2.287102152  -0.30109198  -0.269160131
#> FitDTVARMxID_DTVAR_ID16.Rds  -1.603495082  -0.41504145  -0.606533213
#> FitDTVARMxID_DTVAR_ID17.Rds  -1.805663938  -0.58948983  -0.381692613
#> FitDTVARMxID_DTVAR_ID18.Rds  -1.295775035  -0.44404891  -0.643271386
#> FitDTVARMxID_DTVAR_ID19.Rds  -1.625723832  -0.39079054  -0.518335150
#> FitDTVARMxID_DTVAR_ID20.Rds  -2.024371182  -0.44599515  -0.401670152
#> FitDTVARMxID_DTVAR_ID21.Rds  -2.413017602  -0.53437328  -0.273774632
#> FitDTVARMxID_DTVAR_ID22.Rds  -2.170654918  -0.65640050  -0.204696715
#> FitDTVARMxID_DTVAR_ID23.Rds  -1.298523180  -0.46990196  -0.437565511
#> FitDTVARMxID_DTVAR_ID24.Rds  -2.946057881  -0.40528306  -0.261894465
#> FitDTVARMxID_DTVAR_ID25.Rds  -1.672841858  -0.45033196  -0.433028376
#> FitDTVARMxID_DTVAR_ID26.Rds  -2.613739794  -0.56729383  -0.271837034
#> FitDTVARMxID_DTVAR_ID27.Rds  -1.750281617  -0.50926315  -0.311057845
#> FitDTVARMxID_DTVAR_ID28.Rds  -2.453908719  -1.28984650  -0.065013639
#> FitDTVARMxID_DTVAR_ID29.Rds  -1.001537063  -0.38690208  -0.733895955
#> FitDTVARMxID_DTVAR_ID30.Rds  -1.564677866 -16.76131369  -0.545247983
#> FitDTVARMxID_DTVAR_ID31.Rds  -1.820792759  -0.48096322  -0.361560734
#> FitDTVARMxID_DTVAR_ID32.Rds  -2.150609614  -0.40603345  -0.245628028
#> FitDTVARMxID_DTVAR_ID33.Rds  -1.131925329  -0.56153116  -0.686273396
#> FitDTVARMxID_DTVAR_ID34.Rds  -1.650843349  -0.72802597  -0.474194550
#> FitDTVARMxID_DTVAR_ID35.Rds  -2.035200438  -0.37988925  -0.438693663
#> FitDTVARMxID_DTVAR_ID36.Rds  -1.610175621  -0.44778550  -0.527117296
#> FitDTVARMxID_DTVAR_ID37.Rds  -1.800444121 -17.65484501  -0.347878272
#> FitDTVARMxID_DTVAR_ID38.Rds  -2.174986652  -0.83654660  -0.269752768
#> FitDTVARMxID_DTVAR_ID39.Rds  -1.589005938  -0.43630587  -0.472457696
#> FitDTVARMxID_DTVAR_ID40.Rds  -2.118573734  -0.30828194  -0.426950626
#> FitDTVARMxID_DTVAR_ID41.Rds  -1.646091298  -0.25176552  -0.471804989
#> FitDTVARMxID_DTVAR_ID42.Rds  -2.449350743  -0.31576450  -0.319559582
#> FitDTVARMxID_DTVAR_ID43.Rds  -2.911276207  -0.43885763  -0.220495289
#> FitDTVARMxID_DTVAR_ID44.Rds  -1.396942049  -0.58769829  -0.517099221
#> FitDTVARMxID_DTVAR_ID45.Rds  -2.188596351  -0.40421462  -0.321790906
#> FitDTVARMxID_DTVAR_ID46.Rds  -3.009733848 -16.88875599  -0.316373080
#> FitDTVARMxID_DTVAR_ID47.Rds  -0.009448594  -0.47205657 -16.176203337
#> FitDTVARMxID_DTVAR_ID48.Rds  -1.864561103 -17.58308263  -0.309034659
#> FitDTVARMxID_DTVAR_ID49.Rds  -1.516869934  -0.33898245  -0.492279986
#> FitDTVARMxID_DTVAR_ID50.Rds  -1.975344348  -0.42222817  -0.446715561
#> FitDTVARMxID_DTVAR_ID51.Rds  -1.567154753  -0.56733195  -0.326514156
#> FitDTVARMxID_DTVAR_ID53.Rds  -1.474425513  -0.40754229  -0.486741537
#> FitDTVARMxID_DTVAR_ID54.Rds  -2.232844843 -17.44714472  -0.106170517
#> FitDTVARMxID_DTVAR_ID55.Rds  -2.675614464 -17.54568226  -0.123428352
#> FitDTVARMxID_DTVAR_ID56.Rds  -2.255572920  -0.37992555  -0.288036776
#> FitDTVARMxID_DTVAR_ID57.Rds  -1.464811602  -0.38126119  -0.478541728
#> FitDTVARMxID_DTVAR_ID58.Rds  -1.508022764  -1.16252702  -0.410171252
#> FitDTVARMxID_DTVAR_ID59.Rds  -2.030267107  -0.33510280  -0.508964223
#> FitDTVARMxID_DTVAR_ID60.Rds  -1.767711008  -0.35451410  -0.319437089
#> FitDTVARMxID_DTVAR_ID61.Rds  -1.625348800  -0.41885811  -0.385739955
#> FitDTVARMxID_DTVAR_ID62.Rds  -2.566978047  -0.22179191  -0.259454947
#> FitDTVARMxID_DTVAR_ID63.Rds  -1.717939960  -0.37162166  -0.483891659
#> FitDTVARMxID_DTVAR_ID64.Rds  -1.899813392  -0.35225293  -0.304028463
#> FitDTVARMxID_DTVAR_ID65.Rds  -1.300982223  -0.50944233  -0.793898753
#> FitDTVARMxID_DTVAR_ID66.Rds  -2.030517697  -0.78300638  -0.201019811
#> FitDTVARMxID_DTVAR_ID67.Rds  -1.828900065  -0.37795610  -0.436748718
#> FitDTVARMxID_DTVAR_ID68.Rds  -1.858591232  -0.22911241  -0.329237984
#> FitDTVARMxID_DTVAR_ID69.Rds  -2.353221507  -1.85111949  -0.142284614
#> FitDTVARMxID_DTVAR_ID70.Rds  -2.748482661 -14.49378272  -0.208243987
#> FitDTVARMxID_DTVAR_ID71.Rds  -0.091576265  -0.48496879 -16.812209386
#> FitDTVARMxID_DTVAR_ID72.Rds  -1.604125506 -14.59078315  -0.453878731
#> FitDTVARMxID_DTVAR_ID73.Rds  -0.347488844  -0.43496207  -1.871043820
#> FitDTVARMxID_DTVAR_ID74.Rds  -0.971220703  -0.62068108  -0.900290944
#> FitDTVARMxID_DTVAR_ID75.Rds  -1.278649598 -16.05549943  -0.479348679
#> FitDTVARMxID_DTVAR_ID76.Rds  -1.251697892  -0.51037102  -0.604163978
#> FitDTVARMxID_DTVAR_ID77.Rds  -1.790180661  -0.44809629  -0.476414665
#> FitDTVARMxID_DTVAR_ID78.Rds  -1.509905721  -0.33209167  -0.570610448
#> FitDTVARMxID_DTVAR_ID79.Rds  -1.146345552  -0.38092309  -0.651919598
#> FitDTVARMxID_DTVAR_ID80.Rds  -1.906180450  -0.41203276  -0.435309875
#> FitDTVARMxID_DTVAR_ID81.Rds  -2.053493081  -0.42708058  -0.432056498
#> FitDTVARMxID_DTVAR_ID82.Rds  -1.866965374  -0.65514486  -0.385399111
#> FitDTVARMxID_DTVAR_ID83.Rds  -2.168879360  -1.09314710  -0.071114474
#> FitDTVARMxID_DTVAR_ID84.Rds  -1.895574842  -0.48476540  -0.429010913
#> FitDTVARMxID_DTVAR_ID85.Rds  -1.572080699  -0.41099666  -0.542325339
#> FitDTVARMxID_DTVAR_ID86.Rds  -4.098156227  -0.42297499  -0.008228674
#> FitDTVARMxID_DTVAR_ID87.Rds  -1.821556646  -0.45786805  -0.341870560
#> FitDTVARMxID_DTVAR_ID88.Rds  -1.648625086  -0.56895769  -0.375803104
#> FitDTVARMxID_DTVAR_ID89.Rds  -1.787260612  -0.54822746  -0.394727577
#> FitDTVARMxID_DTVAR_ID90.Rds  -1.270884648  -0.45203713  -0.543552889
#> FitDTVARMxID_DTVAR_ID91.Rds  -2.854401654  -0.25961533  -0.329429767
#> FitDTVARMxID_DTVAR_ID92.Rds  -1.564838362  -0.36078918  -0.448353428
#> FitDTVARMxID_DTVAR_ID93.Rds  -1.951378132  -0.42602671  -0.237135798
#> FitDTVARMxID_DTVAR_ID94.Rds  -1.518321798  -0.78221195  -0.473075217
#> FitDTVARMxID_DTVAR_ID95.Rds  -1.360018624  -0.56825191  -0.629731862
#> FitDTVARMxID_DTVAR_ID96.Rds  -2.215775687  -0.29436537  -0.351963713
#> FitDTVARMxID_DTVAR_ID97.Rds  -0.753641987  -0.42915908  -1.152954359
#> FitDTVARMxID_DTVAR_ID98.Rds  -1.847996950  -0.40585410  -0.477155075
#> FitDTVARMxID_DTVAR_ID99.Rds  -3.065261660  -0.39596570  -0.274356900
#> FitDTVARMxID_DTVAR_ID100.Rds -1.134464942  -0.46720794  -0.699809642
```

#### Proportion of converged cases


``` r
converged(
  fit,
  theta_tol = 0.01,
  prop = TRUE
)
#> [1] 0.88
```

#### Meta-analyze the measurement error covariance matrix for the converged cases


``` r
library(metaVAR)
fixed_theta <- MetaVARMx(
  fit,
  random = FALSE,
  effects = FALSE,
  cov_meas = TRUE,
  theta_tol = 0.01
)
```




``` r
coef(fixed_theta)
#>  alpha_1_1  alpha_2_1
#> -0.4008133 -0.3456229
summary(fixed_theta)
#>                est     se        z p    2.5%   97.5%
#> alpha[1,1] -0.4008 0.0140 -28.6995 0 -0.4282 -0.3734
#> alpha[2,1] -0.3456 0.0134 -25.7253 0 -0.3720 -0.3193
```


``` r
theta_d_values <- coef(fixed_theta)
```

#### Refit the model with fixed measurement error covariance matrix


``` r
fit <- FitDTVARMxID(
  data = data,
  observed = c("y1", "y2"),
  id = "id",
  beta_values = beta_values,
  psi_d_values = psi_d_values,
  psi_l_values = psi_l_values,
  nu_values = nu_values,
  theta_fixed = TRUE,
  theta_d_values = theta_d_values,
  mu0_values = mu0_values,
  sigma0_d_values = sigma0_d_values,
  sigma0_l_values = sigma0_l_values,
  ncores = parallel::detectCores()
)
```

#### Parameter estimates


``` r
random <- MetaVARMx(
  fit,
  effects = TRUE,
  int_meas = TRUE
)
```



``` r
summary(random)
#>                  est     se        z      p    2.5%   97.5%
#> alpha[1,1]    0.7022 0.0131  53.7051 0.0000  0.6766  0.7278
#> alpha[2,1]   -0.1531 0.0142 -10.7960 0.0000 -0.1808 -0.1253
#> alpha[3,1]   -0.1573 0.0120 -13.0906 0.0000 -0.1808 -0.1337
#> alpha[4,1]    0.6886 0.0125  55.2346 0.0000  0.6642  0.7131
#> alpha[5,1]    0.5127 0.0287  17.8583 0.0000  0.4564  0.5689
#> alpha[6,1]   -0.4849 0.0316 -15.3601 0.0000 -0.5468 -0.4230
#> tau_sqr[1,1]  0.0117 0.0022   5.4141 0.0000  0.0075  0.0160
#> tau_sqr[2,1]  0.0085 0.0019   4.3808 0.0000  0.0047  0.0122
#> tau_sqr[3,1] -0.0008 0.0014  -0.5507 0.5819 -0.0035  0.0020
#> tau_sqr[4,1] -0.0011 0.0014  -0.8032 0.4219 -0.0038  0.0016
#> tau_sqr[5,1] -0.0045 0.0038  -1.1836 0.2366 -0.0119  0.0029
#> tau_sqr[6,1]  0.0018 0.0039   0.4548 0.6493 -0.0059  0.0095
#> tau_sqr[2,2]  0.0148 0.0027   5.3881 0.0000  0.0094  0.0202
#> tau_sqr[3,2] -0.0021 0.0015  -1.3703 0.1706 -0.0051  0.0009
#> tau_sqr[4,2]  0.0003 0.0016   0.1647 0.8692 -0.0029  0.0034
#> tau_sqr[5,2] -0.0035 0.0040  -0.8603 0.3896 -0.0114  0.0044
#> tau_sqr[6,2] -0.0019 0.0043  -0.4361 0.6628 -0.0104  0.0066
#> tau_sqr[3,3]  0.0081 0.0019   4.3211 0.0000  0.0044  0.0117
#> tau_sqr[4,3]  0.0041 0.0014   2.8686 0.0041  0.0013  0.0070
#> tau_sqr[5,3] -0.0040 0.0032  -1.2613 0.2072 -0.0103  0.0022
#> tau_sqr[6,3] -0.0024 0.0035  -0.6964 0.4862 -0.0093  0.0044
#> tau_sqr[4,4]  0.0091 0.0020   4.4806 0.0000  0.0051  0.0131
#> tau_sqr[5,4] -0.0045 0.0034  -1.3298 0.1836 -0.0111  0.0021
#> tau_sqr[6,4] -0.0001 0.0037  -0.0181 0.9856 -0.0074  0.0073
#> tau_sqr[5,5]  0.0724 0.0112   6.4581 0.0000  0.0504  0.0944
#> tau_sqr[6,5] -0.0451 0.0103  -4.3825 0.0000 -0.0653 -0.0249
#> tau_sqr[6,6]  0.0907 0.0139   6.5363 0.0000  0.0635  0.1179
#> i_sqr[1,1]    0.8505 0.0235  36.2282 0.0000  0.8045  0.8966
#> i_sqr[2,1]    0.8897 0.0182  48.8538 0.0000  0.8540  0.9254
#> i_sqr[3,1]    0.6948 0.0491  14.1620 0.0000  0.5987  0.7910
#> i_sqr[4,1]    0.7465 0.0422  17.6743 0.0000  0.6637  0.8293
#> i_sqr[5,1]    0.9375 0.0091 103.3930 0.0000  0.9198  0.9553
#> i_sqr[6,1]    0.9595 0.0059 161.5793 0.0000  0.9479  0.9712
```

Extract estimated parameters.


``` r
coefs <- coef(random)
covs <- matrix(
  data = fitDTVARMxID:::.SymofVech(
    x = coefs[7:27],
    k = 6
  ),
  nrow = 6,
  ncol = 6
)
beta_means <- matrix(
  data = coefs[1:4],
  nrow = 2,
  ncol = 2
)
beta_cov <- covs[1:4, 1:4]
nu_means <- coefs[5:6]
nu_cov <- covs[5:6, 5:6]
```

Estimated  values for the transition matrix.


``` r
beta_means
#>            [,1]       [,2]
#> [1,]  0.7022074 -0.1572907
#> [2,] -0.1530578  0.6886382
beta_cov
#>             [,1]        [,2]        [,3]       [,4]
#> [1,]  0.72076259 -0.06601699 -0.09464455 -0.3825826
#> [2,] -0.06601699  0.12238230 -0.02641362 -0.3655070
#> [3,] -0.09464455 -0.02641362 -0.37203777 -0.3814438
#> [4,] -0.38258262 -0.36550698 -0.38144382 -4.4389958
```

Estimated values for the observed means.


``` r
nu_means
#> [1] 0.5126782 -0.4849197
nu_cov
#>           [,1]      [,2]
#> [1,] -5.029790 -2.665211
#> [2,] -2.665211 -2.835657
```

Population values for the transition matrix based on 5 million replications.


``` r
beta_pop_mean
#> [1]  0.6794612 -0.1445571 -0.1946483  0.6367930
beta_pop_cov
#>              [,1]          [,2]          [,3]         [,4]
#> [1,] 1.668398e-02  0.0099324179  0.0003451996 1.140625e-05
#> [2,] 9.932418e-03  0.0147696609 -0.0006384169 8.493977e-04
#> [3,] 3.451996e-04 -0.0006384169  0.0099154757 5.231290e-03
#> [4,] 1.140625e-05  0.0008493977  0.0052312899 1.323857e-02
```

Population values for the observed means.


``` r
nu_mu
#> [1]  0.5 -0.5
nu_sigma
#>       [,1]  [,2]
#> [1,]  0.10 -0.05
#> [2,] -0.05  0.10
```

#### Proportion of converged cases


``` r
converged(
  fit,
  prop = TRUE
)
#> [1] 1
```

## References


