---
title: "Fit the Discrete-Time Vector Autoregressive Model By ID (Adaptive Recovery | 100 Measurement Occasions)"
author: Ivan Jacob Agaloos Pesigan
date: "2025-10-15"
bibliography: "vignettes.bib"
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
nocite: |
  @RCoreTeam-2024
  @Neale-Hunter-Pritikin-etal-2015
  @Hunter-2017
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Fit the Discrete-Time Vector Autoregressive Model By ID (Adaptive Recovery | 100 Measurement Occasions)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---









## Dynamics Description

The *Adaptive Recovery* process reflects an asymmetric regulatory dynamic between two latent constructs---such as stress and coping---where activation in one system initiates a corrective response in the other. Specifically, stress tends to increase coping responses, while coping reduces subsequent stress, producing a negative feedback loop that promotes stability and recovery.

Individuals differ in the strength and balance of these cross-regulatory influences, leading to variability in how quickly they return to equilibrium after disturbances. The process noise covariance is moderate and negatively correlated, representing compensatory fluctuations where increases in stress are often accompanied by decreases in coping, while measurement error variance is small and symmetric across variables.

This configuration captures a psychologically meaningful *stress–response* mechanism, characterized by self-correcting dynamics that stabilize the system over time through coordinated but asymmetric influences.

## Model

The measurement model is given by
\begin{equation}
  \mathbf{y}_{i, t}
  =
  \boldsymbol{\nu}_{i}
  +
  \boldsymbol{\Lambda}
  \boldsymbol{\eta}_{i, t}
  +
  \boldsymbol{\varepsilon}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\varepsilon}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Theta}_{i}
  \right)
\end{equation}
where
$\mathbf{y}_{i, t}$,
$\boldsymbol{\eta}_{i, t}$,
and
$\boldsymbol{\varepsilon}_{i, t}$
are random variables
and
$\boldsymbol{\nu}_{i}$,
$\boldsymbol{\Lambda}$,
and
$\boldsymbol{\Theta}_{i}$
are model parameters.
$\mathbf{y}_{i, t}$
represents a vector of observed random variables,
$\boldsymbol{\eta}_{i, t}$
a vector of latent random variables,
and
$\boldsymbol{\varepsilon}_{i, t}$
a vector of random measurement errors,
at time $t$ and individual $i$.
$\boldsymbol{\Lambda}$
denotes a matrix of factor loadings,
and
$\boldsymbol{\Theta}_{i}$
the covariance matrix of
$\boldsymbol{\varepsilon}$
for individual $i$.
In this model,
$\boldsymbol{\Lambda}$ is an identity matrix and
$\boldsymbol{\Theta}_{i}$ is a symmetric matrix.

The dynamic structure is given by
\begin{equation}
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\beta}_{i}
  \boldsymbol{\eta}_{i, t - 1}
  +
  \boldsymbol{\zeta}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\zeta}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Psi}_{i}
  \right)
\end{equation}
where
$\boldsymbol{\eta}_{i, t}$,
$\boldsymbol{\eta}_{i, t - 1}$,
and
$\boldsymbol{\zeta}_{i, t}$
are random variables,
and
$\boldsymbol{\beta}_{i}$,
and
$\boldsymbol{\Psi}_{i}$
are model parameters.
Here,
$\boldsymbol{\eta}_{i, t}$
is a vector of latent variables
at time $t$ and individual $i$,
$\boldsymbol{\eta}_{i, t - 1}$
represents a vector of latent variables
at time $t - 1$ and individual $i$,
and
$\boldsymbol{\zeta}_{i, t}$
represents a vector of dynamic noise
at time $t$ and individual $i$.
$\boldsymbol{\beta}_{i}$ is
a matrix of autoregression
and cross regression coefficients
for individual $i$,
and
$\boldsymbol{\Psi}_{i}$
the covariance matrix of
$\boldsymbol{\zeta}_{i, t}$
for individual $i$.
In this model,
$\boldsymbol{\Psi}_{i}$ is a symmetric matrix.

## Data Generation

### Notation

Let $t = 10100$ be the number of time points and $n = 100$ be the number of individuals.

Let the measurement model intecept vector $\boldsymbol{\nu}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{c}
  0.8 \\
  0.5 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cc}
  0.15 & 0.05 \\
  0.05 & 0.1 \\
\end{array}
\right) .
\end{equation}

Let the factor loadings matrix $\boldsymbol{\Lambda}$ be given by

\begin{equation}
\boldsymbol{\Lambda}
=
\left(
\begin{array}{cc}
  1 & 0 \\
  0 & 1 \\
\end{array}
\right) .
\end{equation}

Let the measurement error covariance matrix $\boldsymbol{\Theta}$ be given by

\begin{equation}
\boldsymbol{\Theta}
=
\left(
\begin{array}{cc}
  0.5 & 0 \\
  0 & 0.5 \\
\end{array}
\right) .
\end{equation}

Let the initial condition
$\boldsymbol{\eta}_{0}$
be given by

\begin{equation}
\boldsymbol{\eta}_{0} \sim \mathcal{N} \left( \boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}, \boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0} \right) .
\end{equation}

$\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}$ and $\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}$ are functions of $\boldsymbol{\alpha}$ and $\boldsymbol{\beta}$.

Let the transition matrix $\boldsymbol{\beta}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{cc}
  0.6 & -0.3 \\
  0.25 & 0.7 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cccc}
  0.025 & 0.01 & 0 & 0 \\
  0.01 & 0.02 & 0 & 0 \\
  0 & 0 & 0.02 & 0.01 \\
  0 & 0 & 0.01 & 0.025 \\
\end{array}
\right) .
\end{equation}

Let the intercept vector $\boldsymbol{\alpha}$ be fixed to a zero vector.

The `SimNuN` and `SimBetaN` functions from the `simStateSpace` package generates random intercept vectors and transition matrices from the multivariate normal distribution. Note that the `SimBetaN` function generates transition matrices that are weakly stationary with an option to set lower and upper bounds.

Let the dynamic process noise $\boldsymbol{\Psi}$ be given by

\begin{equation}
\boldsymbol{\Psi}
=
\left(
\begin{array}{cc}
  0.25 & -0.1 \\
  -0.1 & 0.22 \\
\end{array}
\right) .
\end{equation}




### R Function Arguments


``` r
n
#> [1] 100
time
#> [1] 10100
burnin
#> [1] 10000
# first mu0 in the list of length n
mu0[[1]]
#> [1] 0 0
# first sigma0 in the list of length n
sigma0[[1]]
#>            [,1]       [,2]
#> [1,]  0.3399277 -0.0557114
#> [2,] -0.0557114  1.1620385
# first sigma0_l in the list of length n
sigma0_l[[1]] # sigma0_l <- t(chol(sigma0))
#>             [,1]     [,2]
#> [1,]  0.58303323 0.000000
#> [2,] -0.09555442 1.073735
alpha
#> [[1]]
#> [1] 0 0
# first beta in the list of length n
beta[[1]]
#>           [,1]       [,2]
#> [1,] 0.5159622 0.01359474
#> [2,] 0.3202660 0.89904484
# first psi in the list of length n
psi[[1]]
#>       [,1]  [,2]
#> [1,]  0.25 -0.10
#> [2,] -0.10  0.22
psi_l[[1]] # psi_l <- t(chol(psi))
#>      [,1]      [,2]
#> [1,]  0.5 0.0000000
#> [2,] -0.2 0.4242641
# first nu in the list of length n
nu[[1]]
#> [1] 1.094299 0.100988
lambda
#> [[1]]
#>      [,1] [,2]
#> [1,]    1    0
#> [2,]    0    1
# first theta in the list of length n
theta[[1]]
#>      [,1] [,2]
#> [1,]  0.5  0.0
#> [2,]  0.0  0.5
theta_l[[1]] # theta_l <- t(chol(theta))
#>           [,1]      [,2]
#> [1,] 0.7071068 0.0000000
#> [2,] 0.0000000 0.7071068
```

### Visualizing the Dynamics Without Process Noise and Measurement Error (n = 5 with Different Initial Condition)

<img src="fig-vignettes-adaptive-recovery-no-error-1.png" width="3300" /><img src="fig-vignettes-adaptive-recovery-no-error-2.png" width="3300" />

### Using the `SimSSMIVary` Function from the `simStateSpace` Package to Simulate Data


``` r
library(simStateSpace)
sim <- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l
)
data <- as.data.frame(sim, burnin = burnin)
head(data)
#>   id time        y1         y2
#> 1  1    0 1.5903935 -1.0269628
#> 2  1    1 0.9288686  0.4296857
#> 3  1    2 2.0010930 -1.2365114
#> 4  1    3 2.2961315 -1.7734153
#> 5  1    4 1.9932917 -1.0469535
#> 6  1    5 1.4911727 -1.1539057
plot(sim, burnin = burnin)
```

<img src="fig-vignettes-adaptive-recovery-error-1.png" width="3300" /><img src="fig-vignettes-adaptive-recovery-error-2.png" width="3300" />

## Model Fitting




``` r
library(OpenMx)
library(fitDTVARMxID)
```

The `FitDTVARMxID` function fits a DT-VAR model on each individual $i$.
To set up the estimation, we first provide **starting values** for each parameter matrix.

### Autoregressive Parameters (`beta`)

The autoregressive coefficient matrix $\boldsymbol{\beta}$ is given starting values.


``` r
beta_values <- beta
```

### Intercepts (`nu`)

The intercept vector $\boldsymbol{\nu}$ is initialized with starting values.


``` r
nu_values <- nu
```

### LDL′-parameterized covariance matrices

Covariances such as `psi` and `theta` are estimated using the LDL′ decomposition of a positive definite covariance matrix. The decomposition expresses a covariance matrix $\Sigma$ as

\begin{equation}
  \boldsymbol{\Sigma} = \left( \mathbf{L} + \mathbf{I} \right) \mathrm{diag} \left( \mathrm{Softplus} \left( \mathbf{d}_{uc} \right) \right) \left( \mathbf{L} + \mathbf{I} \right)^{\prime},
\end{equation}

where:

- $\mathbf{L}$ is a strictly lower-triangular matrix of free parameters (`l_mat_strict`),
- $\mathbf{I}$ is the identity matrix,
- $\mathbf{d}_{uc}$ is an unconstrained vector,
- $\mathrm{Softplus} \left(\mathbf{d}_{uc} \right) = \log \left(1 + \exp \left( \mathbf{d}_{uc} \right) \right)$ ensures strictly positive diagonal entries.

The `LDL()` function extracts this decomposition from a positive definite covariance matrix. It returns:

- `d_uc`: unconstrained diagonal parameters, equal to `InvSoftplus(d_vec)`,
- `d_vec`: diagonal entries, equal to `Softplus(d_uc)`,
- `l_mat_strict`: the strictly lower-triangular factor.


``` r
sigma <- matrix(
  data = c(1.0, 0.5, 0.5, 1.0),
  nrow = 2,
  ncol = 2
)

ldl_sigma <- LDL(sigma)
d_uc <- ldl_sigma$d_uc
l_mat_strict <- ldl_sigma$l_mat_strict
I <- diag(2)
sigma_reconstructed <- (l_mat_strict + I) %*% diag(log1p(exp(d_uc)), 2) %*% t(l_mat_strict + I)
sigma_reconstructed
#>      [,1] [,2]
#> [1,]  1.0  0.5
#> [2,]  0.5  1.0
```

#### Process Noise Covariance Matrix (`psi`)

Starting values for the process noise covariance matrix $\boldsymbol{\Psi}$ are given below, with corresponding LDL′ parameters.


``` r
psi_values <- psi[[1]]
ldl_psi_values <- LDL(psi_values)
psi_d_values <- ldl_psi_values$d_uc
psi_l_values <- ldl_psi_values$l_mat_strict
```


``` r
psi_d_values
#> [1] -1.258692 -1.623449
```


``` r
psi_l_values
#>      [,1] [,2]
#> [1,]  0.0    0
#> [2,] -0.4    0
```

#### Measurement Error Covariance Matrix (`theta`)

Starting values for the measurement error covariance matrix $\boldsymbol{\Theta}$ are given below, with corresponding LDL′ parameters.


``` r
theta_values <- theta[[1]]
ldl_theta_values <- LDL(theta_values)
theta_d_values <- ldl_theta_values$d_uc
theta_l_values <- ldl_theta_values$l_mat_strict
```


``` r
theta_d_values
#> [1] -0.4327521 -0.4327521
```


``` r
theta_l_values
#>      [,1] [,2]
#> [1,]    0    0
#> [2,]    0    0
```

### Initial mean vector (`mu_0`) and covariance matrix (`sigma_0`)

The initial mean vector $\boldsymbol{\mu_0}$ and covariance matrix $\boldsymbol{\Sigma_0}$
are fixed using `mu0` and `sigma0`.


``` r
mu0_values <- mu0
```


``` r
sigma0_values <- lapply(
  X = sigma0,
  FUN = LDL
)
sigma0_d_values <- lapply(
  X = sigma0_values,
  FUN = function(i) {
    i$d_uc
  }
)
sigma0_l_values <- lapply(
  X = sigma0_values,
  FUN = function(i) {
    i$l_mat_strict
  }
)
```

### `FitDTVARMxID`


``` r
fit <- FitDTVARMxID(
  data = data,
  observed = c("y1", "y2"),
  id = "id",
  beta_values = beta_values,
  psi_d_values = psi_d_values,
  psi_l_values = psi_l_values,
  nu_values = nu_values,
  theta_d_values = theta_d_values,
  mu0_values = mu0_values,
  sigma0_d_values = sigma0_d_values,
  sigma0_l_values = sigma0_l_values,
  ncores = parallel::detectCores()
)
```

#### Parameter estimates


``` r
summary(fit, converged = FALSE)
#>                                 beta_1_1      beta_2_1     beta_1_2  beta_2_2
#> FitDTVARMxID_DTVAR_ID1.Rds   0.891933249  0.3883702470  0.001369148 0.8277580
#> FitDTVARMxID_DTVAR_ID2.Rds   0.525685675  0.1872757201 -0.191441756 0.8614542
#> FitDTVARMxID_DTVAR_ID3.Rds   0.443210390  0.6641561626 -0.263146341 0.7315842
#> FitDTVARMxID_DTVAR_ID4.Rds   0.556437283  0.2989876158 -0.538964175 1.0474495
#> FitDTVARMxID_DTVAR_ID5.Rds   0.433065290  0.4058049691 -0.518787385 1.2666593
#> FitDTVARMxID_DTVAR_ID6.Rds   0.742558838  0.4695490935 -0.285887356 0.7898728
#> FitDTVARMxID_DTVAR_ID7.Rds   0.066521634  0.9186957664 -0.220409397 1.0452964
#> FitDTVARMxID_DTVAR_ID8.Rds   0.832774277 -0.4336371621  0.009949946 0.3570512
#> FitDTVARMxID_DTVAR_ID9.Rds   0.655828941  0.2997290364 -0.142947087 0.7114947
#> FitDTVARMxID_DTVAR_ID10.Rds -0.088825416 -0.1026464287 -0.592293419 0.7258938
#> FitDTVARMxID_DTVAR_ID11.Rds  0.543863724  0.1094510369 -0.515901471 0.7634776
#> FitDTVARMxID_DTVAR_ID12.Rds  0.735117462  0.4250683548 -0.319835183 0.7293698
#> FitDTVARMxID_DTVAR_ID14.Rds  0.508346411  0.4352532496 -0.218758713 0.5534799
#> FitDTVARMxID_DTVAR_ID15.Rds  0.597450531  0.2999720230 -0.049523962 0.1901719
#> FitDTVARMxID_DTVAR_ID16.Rds  0.473853368  0.1933743596 -0.086479163 0.8509934
#> FitDTVARMxID_DTVAR_ID17.Rds  0.612979825  0.4444802088 -0.571934613 0.8383781
#> FitDTVARMxID_DTVAR_ID18.Rds  0.311233477  0.3256882630 -1.074894380 0.9846408
#> FitDTVARMxID_DTVAR_ID19.Rds  0.686822263  0.3807302922 -0.353665629 0.4519842
#> FitDTVARMxID_DTVAR_ID20.Rds  0.063728829  0.1653200558 -0.456175560 0.9036263
#> FitDTVARMxID_DTVAR_ID21.Rds  0.030807629  0.1195742054 -0.888279186 0.8563078
#> FitDTVARMxID_DTVAR_ID22.Rds  0.847853812  0.4130206954 -0.441100223 0.4282716
#> FitDTVARMxID_DTVAR_ID23.Rds  0.604369234  1.0502016022  0.057616211 0.5795083
#> FitDTVARMxID_DTVAR_ID24.Rds  0.385487465  0.1432609029  0.062934770 0.6544107
#> FitDTVARMxID_DTVAR_ID25.Rds  0.603505585  0.8667540345  0.021936128 0.2200768
#> FitDTVARMxID_DTVAR_ID26.Rds  0.787061011  0.3098062620 -0.256193975 0.7651951
#> FitDTVARMxID_DTVAR_ID27.Rds  0.714257244  0.5288513753 -0.174594879 0.4030036
#> FitDTVARMxID_DTVAR_ID28.Rds  0.711201978  0.2936070822 -0.260855211 0.8774920
#> FitDTVARMxID_DTVAR_ID29.Rds  0.798570936  0.6522057478 -0.399270721 0.6204112
#> FitDTVARMxID_DTVAR_ID32.Rds  0.407726349  0.0999597505 -0.199706598 0.5268956
#> FitDTVARMxID_DTVAR_ID33.Rds  0.058379733 -0.1781188892 -0.293260879 0.3247224
#> FitDTVARMxID_DTVAR_ID34.Rds  0.585770779  0.3669048381 -0.267754038 0.8684879
#> FitDTVARMxID_DTVAR_ID35.Rds  1.140845587 -0.9753115826  0.072975219 0.3517279
#> FitDTVARMxID_DTVAR_ID36.Rds  0.415031668  0.1510206415 -0.212771651 0.4069516
#> FitDTVARMxID_DTVAR_ID37.Rds  0.299363131 -0.3452600325 -0.130341862 0.5794112
#> FitDTVARMxID_DTVAR_ID38.Rds  0.838358027  0.3828778778 -0.050937937 0.7357237
#> FitDTVARMxID_DTVAR_ID39.Rds  0.677817462  0.5315178115 -0.244104390 0.9469678
#> FitDTVARMxID_DTVAR_ID40.Rds  0.568716428  0.2253218284 -0.349251775 0.9319040
#> FitDTVARMxID_DTVAR_ID42.Rds  0.461578912 -0.0773567590 -0.326600713 0.4246524
#> FitDTVARMxID_DTVAR_ID43.Rds  0.425491179  0.3454384843 -0.973342990 0.8307802
#> FitDTVARMxID_DTVAR_ID44.Rds  0.727301027 -0.3289417795  0.023170174 0.1402863
#> FitDTVARMxID_DTVAR_ID45.Rds  0.299713024  0.2275529145  0.010070983 0.8527952
#> FitDTVARMxID_DTVAR_ID46.Rds  0.221302825  0.5466193137 -0.621959146 1.2916948
#> FitDTVARMxID_DTVAR_ID47.Rds  0.544638172  0.2432266418 -0.498980179 1.0842434
#> FitDTVARMxID_DTVAR_ID48.Rds  0.536431139  0.2854582104 -0.525826031 1.1673821
#> FitDTVARMxID_DTVAR_ID51.Rds  0.583111028  0.2484169725 -0.717146866 0.7800741
#> FitDTVARMxID_DTVAR_ID54.Rds  0.664874295  0.3054175872 -0.206903858 0.8451182
#> FitDTVARMxID_DTVAR_ID55.Rds  0.952027169 -0.3719247011  0.022343015 0.0451868
#> FitDTVARMxID_DTVAR_ID57.Rds  0.199861744  0.2275144434 -2.429421408 1.1563504
#> FitDTVARMxID_DTVAR_ID59.Rds  0.194403552  0.4585135014 -1.037401145 0.7305619
#> FitDTVARMxID_DTVAR_ID60.Rds  0.259687335  0.0172996429 -0.309451117 0.7707282
#> FitDTVARMxID_DTVAR_ID61.Rds  0.379665182  0.5475940368 -0.234706242 1.0304349
#> FitDTVARMxID_DTVAR_ID62.Rds  0.637602817  0.1371428248  0.109809272 0.8688166
#> FitDTVARMxID_DTVAR_ID64.Rds  0.666518201  0.1509881830  0.131475059 0.8072890
#> FitDTVARMxID_DTVAR_ID65.Rds  0.605278822  0.2026068717 -0.823904258 1.0986376
#> FitDTVARMxID_DTVAR_ID66.Rds  0.829800279  0.3258585775 -0.243264615 0.7245768
#> FitDTVARMxID_DTVAR_ID67.Rds  0.859742609  0.5684808766 -0.256647628 0.8274071
#> FitDTVARMxID_DTVAR_ID68.Rds  0.583169603  0.1224313187 -0.341443966 0.6805017
#> FitDTVARMxID_DTVAR_ID70.Rds  0.967318142  0.5868036072 -0.241654917 0.2853651
#> FitDTVARMxID_DTVAR_ID71.Rds  0.524213834  0.3214315031 -0.266551577 1.0273231
#> FitDTVARMxID_DTVAR_ID72.Rds  0.826862345  0.1137583445 -0.578749496 0.8983189
#> FitDTVARMxID_DTVAR_ID73.Rds  0.455605338 -0.1167386846 -0.613325491 0.2882882
#> FitDTVARMxID_DTVAR_ID74.Rds  0.869193006  0.3333738465 -0.298644143 0.5127470
#> FitDTVARMxID_DTVAR_ID75.Rds  0.513422951  0.4088560842 -0.519230066 0.9430130
#> FitDTVARMxID_DTVAR_ID77.Rds -0.003072379  0.5905782991 -0.854277927 1.3146160
#> FitDTVARMxID_DTVAR_ID79.Rds  0.537807430  0.0052154755 -0.281629670 0.1483683
#> FitDTVARMxID_DTVAR_ID81.Rds  0.477680062  0.4558240739 -0.760968889 0.7300378
#> FitDTVARMxID_DTVAR_ID82.Rds  0.234691021  0.3121144421 -0.769990131 0.8147492
#> FitDTVARMxID_DTVAR_ID84.Rds  0.365524705  0.5335170157 -0.695755661 1.1076496
#> FitDTVARMxID_DTVAR_ID85.Rds  0.453841327  0.2503107020 -0.066079183 0.8898314
#> FitDTVARMxID_DTVAR_ID87.Rds  0.172272980  0.4413699684 -0.834811129 0.9481861
#> FitDTVARMxID_DTVAR_ID89.Rds  0.542860367  0.4179168119 -0.083436973 0.7373061
#> FitDTVARMxID_DTVAR_ID91.Rds  0.672483616  0.0826871884 -0.264654593 0.3960112
#> FitDTVARMxID_DTVAR_ID92.Rds  0.851867627  0.0007380925 -0.152342007 0.3438558
#> FitDTVARMxID_DTVAR_ID93.Rds  0.445994922  0.3535639870 -0.763183404 0.8994697
#> FitDTVARMxID_DTVAR_ID95.Rds  0.928409061  0.6578290048 -0.019443594 1.0202836
#> FitDTVARMxID_DTVAR_ID96.Rds  0.575378217  0.0013141373 -0.243097301 0.2766029
#> FitDTVARMxID_DTVAR_ID97.Rds  0.895508324  0.3252730531 -0.448972515 0.4665540
#> FitDTVARMxID_DTVAR_ID99.Rds  0.001618272  1.0503835114 -0.764149529 1.7561700
#>                                   nu_1_1      nu_2_1   psi_l_2_1   psi_d_1_1
#> FitDTVARMxID_DTVAR_ID1.Rds   0.939301918 -0.37610492 -0.99684533 -3.24627733
#> FitDTVARMxID_DTVAR_ID2.Rds   1.569162869 -0.02207429 -0.25098827 -0.83513594
#> FitDTVARMxID_DTVAR_ID3.Rds   0.898391054  0.38723448 -0.41340358 -1.37900813
#> FitDTVARMxID_DTVAR_ID4.Rds   0.312215738  0.03874884 -0.78758275 -1.53290311
#> FitDTVARMxID_DTVAR_ID5.Rds   1.595560507  0.03478322 -0.42615635 -1.47563734
#> FitDTVARMxID_DTVAR_ID6.Rds   1.087408849  0.60846382 -0.51340018 -3.23973148
#> FitDTVARMxID_DTVAR_ID7.Rds   0.508659821  0.12072193 -0.48517314 -0.99224274
#> FitDTVARMxID_DTVAR_ID8.Rds   0.571377687  0.65127557 -0.52898390 -2.12718192
#> FitDTVARMxID_DTVAR_ID9.Rds   0.418214292  0.36001385 -0.40166097 -0.68642102
#> FitDTVARMxID_DTVAR_ID10.Rds  1.040564561  0.48988440 -0.25995405  0.59897002
#> FitDTVARMxID_DTVAR_ID11.Rds  0.920709200  0.72761837  0.02646412  0.22556607
#> FitDTVARMxID_DTVAR_ID12.Rds  1.054403330  0.52600513 -0.23901937 -0.63255273
#> FitDTVARMxID_DTVAR_ID14.Rds  0.921888423  0.66056138 -1.59863784 -1.95850544
#> FitDTVARMxID_DTVAR_ID15.Rds  0.249660973 -0.08562848 -0.43177229 -1.31388639
#> FitDTVARMxID_DTVAR_ID16.Rds  0.096749734 -0.26231902 -0.53425937 -1.58183128
#> FitDTVARMxID_DTVAR_ID17.Rds  1.058870021  0.87583515 -0.58895250 -2.48536050
#> FitDTVARMxID_DTVAR_ID18.Rds  1.293315799  1.18689296  0.04677081 -0.62637554
#> FitDTVARMxID_DTVAR_ID19.Rds -0.072768907  0.28382704 -0.17507578 -0.51446513
#> FitDTVARMxID_DTVAR_ID20.Rds  1.088612029  0.71807914 -0.21758547 -0.13198457
#> FitDTVARMxID_DTVAR_ID21.Rds  0.724891031  0.22257686  0.02732210 -0.32722985
#> FitDTVARMxID_DTVAR_ID22.Rds  0.333576450  0.32456052 -5.61983028 -4.18035777
#> FitDTVARMxID_DTVAR_ID23.Rds  0.639723427  0.45749510 -1.46253859 -1.85430130
#> FitDTVARMxID_DTVAR_ID24.Rds  0.992032728  0.73896902 -0.12434298  0.04905487
#> FitDTVARMxID_DTVAR_ID25.Rds  0.777190869  0.53658788 -1.07484799 -2.28537782
#> FitDTVARMxID_DTVAR_ID26.Rds  0.402573541  0.41085626 -0.39501524 -0.52676600
#> FitDTVARMxID_DTVAR_ID27.Rds  0.587749447  0.28820380 -0.41573295 -1.58823647
#> FitDTVARMxID_DTVAR_ID28.Rds  0.641741482  0.50943673 -0.27714565 -1.63654799
#> FitDTVARMxID_DTVAR_ID29.Rds  0.672736110  0.53372059 -0.80198832 -2.63995655
#> FitDTVARMxID_DTVAR_ID32.Rds  0.758676313  0.47867295  0.06610498 -0.16068345
#> FitDTVARMxID_DTVAR_ID33.Rds  0.634569517  1.01219388 -0.10233244  0.32857770
#> FitDTVARMxID_DTVAR_ID34.Rds  1.042794399  0.87808403 -0.23656394 -0.15535792
#> FitDTVARMxID_DTVAR_ID35.Rds  1.621184382  0.08691480 -6.52823636 -4.04132763
#> FitDTVARMxID_DTVAR_ID36.Rds  1.299545906  0.79647143 -0.31829872  0.07624913
#> FitDTVARMxID_DTVAR_ID37.Rds  0.905630076  0.65718675  0.16332576 -1.25033927
#> FitDTVARMxID_DTVAR_ID38.Rds  0.633924280  0.14129646 -1.14703125 -1.75934026
#> FitDTVARMxID_DTVAR_ID39.Rds -0.434123027  0.20586327 -1.06812850 -2.73912940
#> FitDTVARMxID_DTVAR_ID40.Rds  0.716404647  0.25403077 -1.02497079 -3.11382511
#> FitDTVARMxID_DTVAR_ID42.Rds  0.991696276  0.14852465 -0.03895638 -0.41601987
#> FitDTVARMxID_DTVAR_ID43.Rds  0.596793121  0.15234291 -1.25501092 -2.60226192
#> FitDTVARMxID_DTVAR_ID44.Rds  0.186370484  0.28164243 -0.31653616 -1.53355891
#> FitDTVARMxID_DTVAR_ID45.Rds  1.226389682  0.99971633 -0.43440247 -0.63027024
#> FitDTVARMxID_DTVAR_ID46.Rds  1.099825653  0.61190094 -0.15377895 -1.47529866
#> FitDTVARMxID_DTVAR_ID47.Rds  0.925123614  0.02586152 -0.35350360 -1.07397339
#> FitDTVARMxID_DTVAR_ID48.Rds  0.869479469  1.18381343 -0.35307697 -1.07030766
#> FitDTVARMxID_DTVAR_ID51.Rds -0.210366051 -0.23408695  0.07040242 -0.79401908
#> FitDTVARMxID_DTVAR_ID54.Rds  0.937961738  0.63235160 -0.10449398 -1.06737070
#> FitDTVARMxID_DTVAR_ID55.Rds  0.200802761  0.55514807 -2.52754200 -2.44324814
#> FitDTVARMxID_DTVAR_ID57.Rds  1.108296627  0.74444990  1.11401939 -4.72210343
#> FitDTVARMxID_DTVAR_ID59.Rds  0.899270073  0.17286291 -0.67681278 -1.75629589
#> FitDTVARMxID_DTVAR_ID60.Rds  0.664092045  0.37248569 -0.11949112 -0.05821927
#> FitDTVARMxID_DTVAR_ID61.Rds  0.798324909  0.12159223  0.13336462 -1.56125407
#> FitDTVARMxID_DTVAR_ID62.Rds  0.860144600  1.24824627 -0.33079295 -0.56652202
#> FitDTVARMxID_DTVAR_ID64.Rds  1.257117269  0.15192596 -1.45325331 -2.25457321
#> FitDTVARMxID_DTVAR_ID65.Rds  1.212706399  0.47176399  0.12915511 -1.78716121
#> FitDTVARMxID_DTVAR_ID66.Rds  0.357037217  0.70914081 -0.12198616 -0.88260868
#> FitDTVARMxID_DTVAR_ID67.Rds  0.518783032  0.12609471 -1.01810328 -1.41788993
#> FitDTVARMxID_DTVAR_ID68.Rds  0.654025250  0.39364832 -0.39964877 -1.43466248
#> FitDTVARMxID_DTVAR_ID70.Rds  1.450318803  0.79577508 -2.16045891 -2.32430793
#> FitDTVARMxID_DTVAR_ID71.Rds  1.491548326  0.61119308 -0.45843088 -0.81580574
#> FitDTVARMxID_DTVAR_ID72.Rds  1.399000118  0.78812291  0.09395808 -2.93377786
#> FitDTVARMxID_DTVAR_ID73.Rds  1.049927078  0.17358731 -1.27586343 -2.32101526
#> FitDTVARMxID_DTVAR_ID74.Rds  1.107312854  0.25342635 -0.89658301 -1.14972464
#> FitDTVARMxID_DTVAR_ID75.Rds  0.500533926  0.37778517 -0.61005561 -1.29119368
#> FitDTVARMxID_DTVAR_ID77.Rds  0.607054167  0.90986468 -0.45091841 -0.70858652
#> FitDTVARMxID_DTVAR_ID79.Rds  0.759509324  0.40017329 -0.11449770 -0.41277620
#> FitDTVARMxID_DTVAR_ID81.Rds  0.134639888  0.58282597 -2.82038806 -3.73438817
#> FitDTVARMxID_DTVAR_ID82.Rds  0.675908181  0.43933553 -0.22595975 -0.78800785
#> FitDTVARMxID_DTVAR_ID84.Rds  0.199311675  0.67999514 -0.36555917 -2.55135362
#> FitDTVARMxID_DTVAR_ID85.Rds  0.204880272  0.91791623 -0.37220160 -1.17640599
#> FitDTVARMxID_DTVAR_ID87.Rds  1.061028085  0.23799295 -0.12825380 -0.77095381
#> FitDTVARMxID_DTVAR_ID89.Rds  0.869043162  0.90127435 -0.53221426 -0.83801554
#> FitDTVARMxID_DTVAR_ID91.Rds  1.349062485  0.93653861 -1.19310205 -1.65496214
#> FitDTVARMxID_DTVAR_ID92.Rds  1.032204835  1.05312421 -0.73106818 -2.93605304
#> FitDTVARMxID_DTVAR_ID93.Rds  0.793369809 -0.14390230 -0.77252829 -2.48187741
#> FitDTVARMxID_DTVAR_ID95.Rds  0.785570675  0.03165241 -8.33441595 -6.79962834
#> FitDTVARMxID_DTVAR_ID96.Rds  0.002265328  0.27659021 -0.01088166 -1.03880254
#> FitDTVARMxID_DTVAR_ID97.Rds  1.264685551  0.89664047 -0.86830880 -2.37750216
#> FitDTVARMxID_DTVAR_ID99.Rds  0.266345009  0.51605948 -0.73444968 -1.87425947
#>                                psi_d_2_1  theta_d_1_1   theta_d_2_1
#> FitDTVARMxID_DTVAR_ID1.Rds   -1.73122835  -0.20360355  -0.669208169
#> FitDTVARMxID_DTVAR_ID2.Rds   -1.32103721  -0.16642902  -0.170358694
#> FitDTVARMxID_DTVAR_ID3.Rds   -3.20129666  -0.47930955   0.147433315
#> FitDTVARMxID_DTVAR_ID4.Rds   -2.16331635  -0.13182870  -0.929897141
#> FitDTVARMxID_DTVAR_ID5.Rds  -23.67657235  -0.35514843   0.311421993
#> FitDTVARMxID_DTVAR_ID6.Rds   -0.89568140  -0.03987728  -0.767997203
#> FitDTVARMxID_DTVAR_ID7.Rds   -7.79973672  -0.30438439  -0.358840675
#> FitDTVARMxID_DTVAR_ID8.Rds   -0.26100554  -0.17140893  -1.451590643
#> FitDTVARMxID_DTVAR_ID9.Rds   -2.93015884  -0.62660595  -0.042397882
#> FitDTVARMxID_DTVAR_ID10.Rds  -1.53890318 -16.72271591  -0.406785611
#> FitDTVARMxID_DTVAR_ID11.Rds  -2.20041759  -1.87705028  -0.333557775
#> FitDTVARMxID_DTVAR_ID12.Rds  -2.03066322  -0.77350845  -0.247274378
#> FitDTVARMxID_DTVAR_ID14.Rds  -0.50013694  -0.02454246 -18.133619014
#> FitDTVARMxID_DTVAR_ID15.Rds  -0.04338801  -0.21967305 -19.704192020
#> FitDTVARMxID_DTVAR_ID16.Rds  -1.59641802  -0.32212215  -0.684587671
#> FitDTVARMxID_DTVAR_ID17.Rds  -3.07526299   0.14700070  -0.626924238
#> FitDTVARMxID_DTVAR_ID18.Rds  -2.66567990  -1.27597175  -0.496686175
#> FitDTVARMxID_DTVAR_ID19.Rds  -2.38620466  -0.53225922  -0.645215978
#> FitDTVARMxID_DTVAR_ID20.Rds  -1.84165056 -19.23645938  -0.331867567
#> FitDTVARMxID_DTVAR_ID21.Rds  -2.00905999 -18.25311047  -0.221992793
#> FitDTVARMxID_DTVAR_ID22.Rds -18.73096920  -0.14561023  -1.126524250
#> FitDTVARMxID_DTVAR_ID23.Rds  -1.47145218   0.12492275  -2.334177661
#> FitDTVARMxID_DTVAR_ID24.Rds  -1.71457510 -20.53069682  -0.533892462
#> FitDTVARMxID_DTVAR_ID25.Rds  -0.36401338  -0.38596000  -3.731274882
#> FitDTVARMxID_DTVAR_ID26.Rds  -1.22417673  -1.05747522  -0.802355433
#> FitDTVARMxID_DTVAR_ID27.Rds   0.22185085  -0.39273050 -19.665603068
#> FitDTVARMxID_DTVAR_ID28.Rds  -2.16783243  -0.67431690  -0.344711216
#> FitDTVARMxID_DTVAR_ID29.Rds  -1.36176537  -0.39106809  -0.575557582
#> FitDTVARMxID_DTVAR_ID32.Rds  -1.29273405  -3.05052236  -1.055038072
#> FitDTVARMxID_DTVAR_ID33.Rds  -0.13220883 -17.52768947 -25.565424624
#> FitDTVARMxID_DTVAR_ID34.Rds  -2.03517342  -0.84694965  -0.741092051
#> FitDTVARMxID_DTVAR_ID35.Rds -21.83921642  -0.15546901 -20.449340649
#> FitDTVARMxID_DTVAR_ID36.Rds  -0.31784090  -2.15241093  -2.522948579
#> FitDTVARMxID_DTVAR_ID37.Rds  -0.21393006  -0.56758893  -0.826611526
#> FitDTVARMxID_DTVAR_ID38.Rds  -1.91091146  -0.41970504  -0.766746940
#> FitDTVARMxID_DTVAR_ID39.Rds  -3.53934778  -0.10003576  -0.346927814
#> FitDTVARMxID_DTVAR_ID40.Rds  -1.93709032   0.10644174  -0.594458376
#> FitDTVARMxID_DTVAR_ID42.Rds  -0.13219844  -0.96825973  -1.000423556
#> FitDTVARMxID_DTVAR_ID43.Rds -21.96942039  -0.52374754  -0.456545176
#> FitDTVARMxID_DTVAR_ID44.Rds  -0.29518563  -0.47911563 -17.046383275
#> FitDTVARMxID_DTVAR_ID45.Rds  -2.30765983  -1.08610627  -0.226904579
#> FitDTVARMxID_DTVAR_ID46.Rds  -4.64248738  -0.75909873   0.271928325
#> FitDTVARMxID_DTVAR_ID47.Rds  -4.42033256  -0.13385191  -0.275130870
#> FitDTVARMxID_DTVAR_ID48.Rds  -5.14023072  -0.96485693   0.137953129
#> FitDTVARMxID_DTVAR_ID51.Rds  -2.01259240  -0.79228936  -0.552673358
#> FitDTVARMxID_DTVAR_ID54.Rds  -2.25699079  -0.94567416  -0.536611624
#> FitDTVARMxID_DTVAR_ID55.Rds  -2.89870492  -0.45710644  -1.415655762
#> FitDTVARMxID_DTVAR_ID57.Rds -17.01454782  -0.43772290   0.053044684
#> FitDTVARMxID_DTVAR_ID59.Rds  -2.75737530  -0.38520045  -0.624405164
#> FitDTVARMxID_DTVAR_ID60.Rds  -0.90269843 -20.65147142  -0.766589004
#> FitDTVARMxID_DTVAR_ID61.Rds -18.35858862  -0.50067265  -0.050355251
#> FitDTVARMxID_DTVAR_ID62.Rds  -3.55756065  -1.46922354  -0.319975899
#> FitDTVARMxID_DTVAR_ID64.Rds  -4.69677041  -0.43558059  -0.064792553
#> FitDTVARMxID_DTVAR_ID65.Rds -17.22047004  -0.61935165  -0.110729905
#> FitDTVARMxID_DTVAR_ID66.Rds  -1.08492286  -0.17792956  -1.068956140
#> FitDTVARMxID_DTVAR_ID67.Rds  -2.66931715  -0.44634717  -0.714528008
#> FitDTVARMxID_DTVAR_ID68.Rds  -1.16307895  -0.79532143  -0.793198314
#> FitDTVARMxID_DTVAR_ID70.Rds  -1.61698886  -0.15576833 -16.428143026
#> FitDTVARMxID_DTVAR_ID71.Rds -17.68446695  -0.78220033  -0.174998938
#> FitDTVARMxID_DTVAR_ID72.Rds  -5.14662920  -0.15641160  -0.432470462
#> FitDTVARMxID_DTVAR_ID73.Rds  -1.65182543  -0.45704417  -0.798766901
#> FitDTVARMxID_DTVAR_ID74.Rds -22.97042597  -0.24407452  -0.285369775
#> FitDTVARMxID_DTVAR_ID75.Rds  -2.53822149  -0.79040541  -0.370349847
#> FitDTVARMxID_DTVAR_ID77.Rds  -4.28058640  -1.05501227  -0.001506834
#> FitDTVARMxID_DTVAR_ID79.Rds   0.06943430  -2.17494291 -17.356298560
#> FitDTVARMxID_DTVAR_ID81.Rds -20.26431240  -0.07618337  -0.522128846
#> FitDTVARMxID_DTVAR_ID82.Rds  -2.24137202  -1.48445198  -0.407383585
#> FitDTVARMxID_DTVAR_ID84.Rds  -2.74344375  -0.54854312  -0.226033335
#> FitDTVARMxID_DTVAR_ID85.Rds  -2.35435533  -0.82768010  -0.392903892
#> FitDTVARMxID_DTVAR_ID87.Rds  -2.53023148  -1.04717073  -0.674608699
#> FitDTVARMxID_DTVAR_ID89.Rds  -1.15269343  -0.77453237  -0.183084629
#> FitDTVARMxID_DTVAR_ID91.Rds  -0.09752642  -0.44296175 -27.689403091
#> FitDTVARMxID_DTVAR_ID92.Rds   0.31144396   0.04177204 -20.470223871
#> FitDTVARMxID_DTVAR_ID93.Rds  -2.47909621  -0.62637455  -0.376552224
#> FitDTVARMxID_DTVAR_ID95.Rds -19.70779881   0.22061321  -0.351433856
#> FitDTVARMxID_DTVAR_ID96.Rds  -0.15530072  -0.89359840 -24.067823337
#> FitDTVARMxID_DTVAR_ID97.Rds  -0.60677697  -0.47966999  -1.019377110
#> FitDTVARMxID_DTVAR_ID99.Rds -22.19623365  -0.14835548  -0.324532196
```

#### Proportion of converged cases


``` r
converged(
  fit,
  theta_tol = 0.01,
  prop = TRUE
)
#> [1] 0.62
```

#### Meta-analyze the measurement error covariance matrix for the converged cases


``` r
library(metaVAR)
fixed_theta <- MetaVARMx(
  fit,
  random = FALSE,
  effects = FALSE,
  cov_meas = TRUE,
  theta_tol = 0.01
)
```




``` r
coef(fixed_theta)
#>  alpha_1_1  alpha_2_1
#> -0.3361524 -0.3476882
summary(fixed_theta)
#>                est     se       z p    2.5%   97.5%
#> alpha[1,1] -0.3362 0.0437 -7.6956 0 -0.4218 -0.2505
#> alpha[2,1] -0.3477 0.0396 -8.7890 0 -0.4252 -0.2702
```


``` r
theta_d_values <- coef(fixed_theta)
```

#### Refit the model with fixed measurement error covariance matrix


``` r
fit <- FitDTVARMxID(
  data = data,
  observed = c("y1", "y2"),
  id = "id",
  beta_values = beta_values,
  psi_d_values = psi_d_values,
  psi_l_values = psi_l_values,
  nu_values = nu_values,
  theta_fixed = TRUE,
  theta_d_values = theta_d_values,
  mu0_values = mu0_values,
  sigma0_d_values = sigma0_d_values,
  sigma0_l_values = sigma0_l_values,
  ncores = parallel::detectCores()
)
```

#### Parameter estimates


``` r
random <- MetaVARMx(
  fit,
  effects = TRUE,
  int_meas = TRUE
)
```



``` r
summary(random)
#>                  est     se       z      p    2.5%   97.5%
#> alpha[1,1]    0.6837 0.0203 33.6450 0.0000  0.6439  0.7235
#> alpha[2,1]    0.2567 0.0193 13.3275 0.0000  0.2189  0.2944
#> alpha[3,1]   -0.2481 0.0280 -8.8734 0.0000 -0.3029 -0.1933
#> alpha[4,1]    0.8034 0.0250 32.1779 0.0000  0.7545  0.8524
#> alpha[5,1]    0.7488 0.0450 16.6285 0.0000  0.6605  0.8370
#> alpha[6,1]    0.5006 0.0345 14.4988 0.0000  0.4329  0.5682
#> tau_sqr[1,1]  0.0082 0.0037  2.2207 0.0264  0.0010  0.0154
#> tau_sqr[2,1]  0.0033 0.0029  1.1577 0.2470 -0.0023  0.0090
#> tau_sqr[3,1]  0.0030 0.0042  0.7197 0.4717 -0.0052  0.0112
#> tau_sqr[4,1] -0.0035 0.0039 -0.9034 0.3663 -0.0111  0.0041
#> tau_sqr[5,1] -0.0023 0.0076 -0.2997 0.7644 -0.0173  0.0127
#> tau_sqr[6,1]  0.0015 0.0056  0.2708 0.7866 -0.0095  0.0126
#> tau_sqr[2,2]  0.0111 0.0041  2.7331 0.0063  0.0031  0.0190
#> tau_sqr[3,2] -0.0046 0.0042 -1.0911 0.2752 -0.0128  0.0036
#> tau_sqr[4,2] -0.0010 0.0042 -0.2407 0.8098 -0.0093  0.0072
#> tau_sqr[5,2] -0.0049 0.0072 -0.6804 0.4963 -0.0191  0.0092
#> tau_sqr[6,2] -0.0042 0.0055 -0.7690 0.4419 -0.0150  0.0066
#> tau_sqr[3,3]  0.0289 0.0084  3.4417 0.0006  0.0124  0.0453
#> tau_sqr[4,3]  0.0033 0.0064  0.5176 0.6047 -0.0092  0.0158
#> tau_sqr[5,3]  0.0075 0.0110  0.6823 0.4950 -0.0141  0.0292
#> tau_sqr[6,3]  0.0088 0.0088  1.0074 0.3138 -0.0084  0.0260
#> tau_sqr[4,4]  0.0274 0.0087  3.1516 0.0016  0.0104  0.0445
#> tau_sqr[5,4]  0.0045 0.0100  0.4505 0.6524 -0.0151  0.0241
#> tau_sqr[6,4] -0.0076 0.0074 -1.0311 0.3025 -0.0221  0.0069
#> tau_sqr[5,5]  0.1713 0.0275  6.2377 0.0000  0.1175  0.2252
#> tau_sqr[6,5]  0.0381 0.0152  2.5078 0.0121  0.0083  0.0678
#> tau_sqr[6,6]  0.0913 0.0160  5.7080 0.0000  0.0600  0.1227
#> i_sqr[1,1]    0.3048 0.0954  3.1945 0.0014  0.1178  0.4918
#> i_sqr[2,1]    0.4227 0.0893  4.7348 0.0000  0.2477  0.5977
#> i_sqr[3,1]    0.6065 0.0693  8.7460 0.0000  0.4706  0.7424
#> i_sqr[4,1]    0.5916 0.0767  7.7170 0.0000  0.4413  0.7418
#> i_sqr[5,1]    0.9154 0.0124 73.7271 0.0000  0.8911  0.9397
#> i_sqr[6,1]    0.8762 0.0190 46.0915 0.0000  0.8389  0.9134
```

Extract estimated parameters.


``` r
coefs <- coef(random)
covs <- matrix(
  data = fitDTVARMxID:::.SymofVech(
    x = coefs[7:27],
    k = 6
  ),
  nrow = 6,
  ncol = 6
)
beta_means <- matrix(
  data = coefs[1:4],
  nrow = 2,
  ncol = 2
)
beta_cov <- covs[1:4, 1:4]
nu_means <- coefs[5:6]
nu_cov <- covs[5:6, 5:6]
```

Estimated  values for the transition matrix.


``` r
beta_means
#>           [,1]       [,2]
#> [1,] 0.6837171 -0.2481148
#> [2,] 0.2566882  0.8034480
beta_cov
#>            [,1]        [,2]       [,3]       [,4]
#> [1,]  0.4067441  0.36739225 -0.4281285 -0.2800103
#> [2,]  0.3673922  0.04230451 -0.4085328 -0.4987218
#> [3,] -0.4281285 -0.40853278  0.2215989  0.1003916
#> [4,] -0.2800103 -0.49872184  0.1003916 -4.8015855
```

Estimated values for the observed means.


``` r
nu_means
#> [1] 0.7487578 0.5005598
nu_cov
#>           [,1]      [,2]
#> [1,] -3.677460 -1.703005
#> [2,] -1.703005 -2.522347
```

Population values for the transition matrix based on 5 million replications.


``` r
beta_pop_mean
#> [1]  0.5975226  0.2495715 -0.3054649  0.6893696
beta_pop_cov
#>               [,1]         [,2]         [,3]          [,4]
#> [1,]  2.386517e-02 0.0092591880 8.078956e-05 -0.0002817067
#> [2,]  9.259188e-03 0.0193540268 1.323752e-04  0.0001410741
#> [3,]  8.078956e-05 0.0001323752 1.883487e-02  0.0084724601
#> [4,] -2.817067e-04 0.0001410741 8.472460e-03  0.0222254212
```

Population values for the observed means.


``` r
nu_mu
#> [1] 0.8 0.5
nu_sigma
#>      [,1] [,2]
#> [1,] 0.15 0.05
#> [2,] 0.05 0.10
```

#### Proportion of converged cases


``` r
converged(
  fit,
  prop = TRUE
)
#> [1] 0.95
```

## References


